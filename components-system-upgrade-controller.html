<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SUSE Edge Documentation | System Upgrade Controller</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="System Upgrade Controller"/>
<meta name="description" content="See the System Upgrade Controller documentation."/>
<meta name="book-title" content="SUSE Edge Documentation"/>
<meta name="chapter-title" content="Chapter 22. System Upgrade Controller"/>
<meta name="tracker-url" content="https://github.com/suse-edge/suse-edge.github.io/issues/new"/>
<meta name="tracker-type" content="gh"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="System Upgrade Controller"/>
<meta property="og:description" content="See the System Upgrade Controller documentation."/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="System Upgrade Controller"/>
<meta name="twitter:description" content="See the System Upgrade Controller documentation."/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    

    "headline": "System Upgrade Controller",
  
    "description": "System Upgrade Controller",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="components-kubevirt.html" title="Chapter 21. Edge Virtualization"/><link rel="next" href="components-upgrade-controller.html" title="Chapter 23. Upgrade Controller"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="wide offline js-off"><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">SUSE Edge Documentation</a><span> / </span><a class="crumb" href="id-components.html">Components</a><span> / </span><a class="crumb" href="components-system-upgrade-controller.html">System Upgrade Controller</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">SUSE Edge Documentation</div><ol><li><a href="suse-edge-documentation.html" class=" "><span class="title-number"> </span><span class="title-name">SUSE Edge 3.4 Documentation</span></a></li><li><a href="id-quick-starts.html" class="has-children "><span class="title-number">I </span><span class="title-name">Quick Starts</span></a><ol><li><a href="quickstart-metal3.html" class=" "><span class="title-number">1 </span><span class="title-name">BMC automated deployments with Metal<sup>3</sup></span></a></li><li><a href="quickstart-elemental.html" class=" "><span class="title-number">2 </span><span class="title-name">Remote host onboarding with Elemental</span></a></li><li><a href="quickstart-eib.html" class=" "><span class="title-number">3 </span><span class="title-name">Standalone clusters with Edge Image Builder</span></a></li><li><a href="quickstart-suma.html" class=" "><span class="title-number">4 </span><span class="title-name">SUSE Multi-Linux Manager</span></a></li></ol></li><li class="active"><a href="id-components.html" class="has-children you-are-here"><span class="title-number">II </span><span class="title-name">Components</span></a><ol><li><a href="components-rancher.html" class=" "><span class="title-number">5 </span><span class="title-name">Rancher</span></a></li><li><a href="components-rancher-dashboard-extensions.html" class=" "><span class="title-number">6 </span><span class="title-name">Rancher Dashboard Extensions</span></a></li><li><a href="components-rancher-turtles.html" class=" "><span class="title-number">7 </span><span class="title-name">Rancher Turtles</span></a></li><li><a href="components-fleet.html" class=" "><span class="title-number">8 </span><span class="title-name">Fleet</span></a></li><li><a href="components-slmicro.html" class=" "><span class="title-number">9 </span><span class="title-name">SUSE Linux Micro</span></a></li><li><a href="components-metal3.html" class=" "><span class="title-number">10 </span><span class="title-name">Metal<sup>3</sup></span></a></li><li><a href="components-eib.html" class=" "><span class="title-number">11 </span><span class="title-name">Edge Image Builder</span></a></li><li><a href="components-nmc.html" class=" "><span class="title-number">12 </span><span class="title-name">Edge Networking</span></a></li><li><a href="components-elemental.html" class=" "><span class="title-number">13 </span><span class="title-name">Elemental</span></a></li><li><a href="components-akri.html" class=" "><span class="title-number">14 </span><span class="title-name">Akri</span></a></li><li><a href="components-k3s.html" class=" "><span class="title-number">15 </span><span class="title-name">K3s</span></a></li><li><a href="components-rke2.html" class=" "><span class="title-number">16 </span><span class="title-name">RKE2</span></a></li><li><a href="components-suse-storage.html" class=" "><span class="title-number">17 </span><span class="title-name">SUSE Storage</span></a></li><li><a href="components-suse-security.html" class=" "><span class="title-number">18 </span><span class="title-name">SUSE Security</span></a></li><li><a href="components-metallb.html" class=" "><span class="title-number">19 </span><span class="title-name">MetalLB</span></a></li><li><a href="components-eco.html" class=" "><span class="title-number">20 </span><span class="title-name">Endpoint Copier Operator</span></a></li><li><a href="components-kubevirt.html" class=" "><span class="title-number">21 </span><span class="title-name">Edge Virtualization</span></a></li><li><a href="components-system-upgrade-controller.html" class=" you-are-here"><span class="title-number">22 </span><span class="title-name">System Upgrade Controller</span></a></li><li><a href="components-upgrade-controller.html" class=" "><span class="title-number">23 </span><span class="title-name">Upgrade Controller</span></a></li><li><a href="components-suma.html" class=" "><span class="title-number">24 </span><span class="title-name">SUSE Multi-Linux Manager</span></a></li></ol></li><li><a href="id-how-to-guides.html" class="has-children "><span class="title-number">III </span><span class="title-name">How-To Guides</span></a><ol><li><a href="guides-metallb-k3s.html" class=" "><span class="title-number">25 </span><span class="title-name">MetalLB on K3s (using Layer 2 Mode)</span></a></li><li><a href="guides-metallb-k3s-l3.html" class=" "><span class="title-number">26 </span><span class="title-name">MetalLB on K3s (using Layer 3 Mode)</span></a></li><li><a href="guides-metallb-kubernetes.html" class=" "><span class="title-number">27 </span><span class="title-name">MetalLB in front of the Kubernetes API server</span></a></li><li><a href="id-air-gapped-deployments-with-edge-image-builder.html" class=" "><span class="title-number">28 </span><span class="title-name">Air-gapped deployments with Edge Image Builder</span></a></li><li><a href="guides-kiwi-builder-images.html" class=" "><span class="title-number">29 </span><span class="title-name">Building Updated SUSE Linux Micro Images with Kiwi</span></a></li><li><a href="guides-clusterclass-example.html" class=" "><span class="title-number">30 </span><span class="title-name">Using clusterclass to deploy downstream clusters</span></a></li></ol></li><li><a href="tips-and-tricks.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Tips and Tricks</span></a><ol><li><a href="tips-edge-image-builder.html" class=" "><span class="title-number">31 </span><span class="title-name">Edge Image Builder</span></a></li><li><a href="tips-elemental.html" class=" "><span class="title-number">32 </span><span class="title-name">Elemental</span></a></li></ol></li><li><a href="id-third-party-integration.html" class="has-children "><span class="title-number">V </span><span class="title-name">Third-Party Integration</span></a><ol><li><a href="integrations-nats.html" class=" "><span class="title-number">33 </span><span class="title-name">NATS</span></a></li><li><a href="id-nvidia-gpus-on-suse-linux-micro.html" class=" "><span class="title-number">34 </span><span class="title-name">NVIDIA GPUs on SUSE Linux Micro</span></a></li></ol></li><li><a href="day-2-operations.html" class="has-children "><span class="title-number">VI </span><span class="title-name">Day 2 Operations</span></a><ol><li><a href="day2-migration.html" class=" "><span class="title-number">35 </span><span class="title-name">Edge 3.3 migration</span></a></li><li><a href="day2-mgmt-cluster.html" class=" "><span class="title-number">36 </span><span class="title-name">Management Cluster</span></a></li><li><a href="day2-downstream-clusters.html" class=" "><span class="title-number">37 </span><span class="title-name">Downstream clusters</span></a></li></ol></li><li><a href="id-suse-telco-cloud-documentation.html" class="has-children "><span class="title-number">VII </span><span class="title-name">SUSE Telco Cloud Documentation</span></a><ol><li><a href="atip.html" class=" "><span class="title-number">38 </span><span class="title-name">SUSE Telco Cloud</span></a></li><li><a href="atip-architecture.html" class=" "><span class="title-number">39 </span><span class="title-name">Concept &amp; Architecture</span></a></li><li><a href="atip-requirements.html" class=" "><span class="title-number">40 </span><span class="title-name">Requirements &amp; Assumptions</span></a></li><li><a href="atip-management-cluster.html" class=" "><span class="title-number">41 </span><span class="title-name">Setting up the management cluster</span></a></li><li><a href="atip-features.html" class=" "><span class="title-number">42 </span><span class="title-name">Telco features configuration</span></a></li><li><a href="atip-automated-provisioning.html" class=" "><span class="title-number">43 </span><span class="title-name">Fully automated directed network provisioning</span></a></li><li><a href="atip-lifecycle.html" class=" "><span class="title-number">44 </span><span class="title-name">Lifecycle actions</span></a></li></ol></li><li><a href="id-troubleshooting-3.html" class="has-children "><span class="title-number">VIII </span><span class="title-name">Troubleshooting</span></a><ol><li><a href="general-troubleshooting-principles.html" class=" "><span class="title-number">45 </span><span class="title-name">General Troubleshooting Principles</span></a></li><li><a href="troubleshooting-kiwi.html" class=" "><span class="title-number">46 </span><span class="title-name">Troubleshooting Kiwi</span></a></li><li><a href="troubleshooting-edge-image-builder.html" class=" "><span class="title-number">47 </span><span class="title-name">Troubleshooting Edge Image Builder (EIB)</span></a></li><li><a href="troubleshooting-edge-networking.html" class=" "><span class="title-number">48 </span><span class="title-name">Troubleshooting Edge Networking (NMC)</span></a></li><li><a href="troubleshooting-phone-home-scenarios.html" class=" "><span class="title-number">49 </span><span class="title-name">Troubleshooting Phone-Home scenarios</span></a></li><li><a href="troubleshooting-directed-network-provisioning.html" class=" "><span class="title-number">50 </span><span class="title-name">Troubleshooting Directed-network provisioning</span></a></li><li><a href="troubleshooting-other-components.html" class=" "><span class="title-number">51 </span><span class="title-name">Troubleshooting Other components</span></a></li><li><a href="collecting-diagnostics-for-support.html" class=" "><span class="title-number">52 </span><span class="title-name">Collecting Diagnostics for Support</span></a></li></ol></li><li><a href="id-appendix.html" class="has-children "><span class="title-number">IX </span><span class="title-name">Appendix</span></a><ol><li><a href="id-release-notes.html" class=" "><span class="title-number">53 </span><span class="title-name">Release Notes</span></a></li></ol></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="components-system-upgrade-controller" data-id-title="System Upgrade Controller"><div class="titlepage"><div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">22 </span><span class="title-name">System Upgrade Controller</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>See the <a class="link" href="https://github.com/rancher/system-upgrade-controller" target="_blank">System Upgrade Controller documentation</a>.</p><div class="blockquote"><blockquote class="blockquote"><p>The System Upgrade Controller (SUC) aims to provide a general-purpose, Kubernetes-native upgrade controller (for nodes). It introduces a new CRD, the Plan, for defining any and all of your upgrade policies/requirements. A Plan is an outstanding intent to mutate nodes in your cluster.</p></blockquote></div><section class="sect1" id="id-how-does-suse-edge-use-system-upgrade-controller" data-id-title="How does SUSE Edge use System Upgrade Controller?"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">22.1 </span><span class="title-name">How does SUSE Edge use System Upgrade Controller?</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#id-how-does-suse-edge-use-system-upgrade-controller">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>SUSE Edge uses <code class="literal">SUC</code> to facilitate various "Day 2" operations related to OS and Kubernetes version upgrades on management and downstream clusters.</p><p>"Day 2" operations are defined through <code class="literal">SUC Plans</code>. Based on these plans, <code class="literal">SUC</code> deploys workloads on each node to execute the respective "Day 2" operation.</p><p><code class="literal">SUC</code> is also used within the <a class="xref" href="components-upgrade-controller.html" title="Chapter 23. Upgrade Controller">Chapter 23, <em>Upgrade Controller</em></a>. To learn more about the key differences between SUC and the Upgrade Controller, see <a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-uc-vs-suc" title="23.2. Upgrade Controller vs System Upgrade Controller">Section 23.2, “Upgrade Controller vs System Upgrade Controller”</a>.</p></section><section class="sect1" id="components-system-upgrade-controller-install" data-id-title="Installing the System Upgrade Controller"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">22.2 </span><span class="title-name">Installing the System Upgrade Controller</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-install">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div id="id-1.4.20.5.2" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important</div><p>Starting with Rancher <a class="link" href="https://github.com/rancher/rancher/releases/tag/v2.10.0" target="_blank">v2.10.0</a>, the <code class="literal">System Upgrade Controller</code> is installed automatically.</p><p>Follow the steps below <span class="strong"><strong>only</strong></span> if your environment is <span class="strong"><strong>not</strong></span> managed by Rancher, or if your Rancher version is lesser than <code class="literal">v2.10.0</code>.</p></div><p>We recommend that you install SUC through Fleet (<a class="xref" href="components-fleet.html" title="Chapter 8. Fleet">Chapter 8, <em>Fleet</em></a>) located in the <a class="link" href="https://github.com/suse-edge/fleet-examples" target="_blank">suse-edge/fleet-examples</a> repository.</p><div id="id-1.4.20.5.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>The resources offered by the <code class="literal">suse-edge/fleet-examples</code> repository <span class="strong"><strong>must</strong></span> always be used from a valid <a class="link" href="https://github.com/suse-edge/fleet-examples/releases" target="_blank">fleet-examples release</a>. To determine which release you need to use, refer to the Release Notes (<a class="xref" href="id-release-notes.html#release-notes" title="53.1. Abstract">Section 53.1, “Abstract”</a>).</p></div><p>If you are unable to use Fleet for the installation of SUC, you can install it through Rancher’s Helm chart repository, or incorporate the Rancher’s Helm chart in your own third-party GitOps workflow.</p><p>This section covers:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Fleet installation (<a class="xref" href="components-system-upgrade-controller.html#components-system-upgrade-controller-fleet" title="22.2.1. System Upgrade Controller Fleet installation">Section 22.2.1, “System Upgrade Controller Fleet installation”</a>)</p></li><li class="listitem"><p>Helm installation (<a class="xref" href="components-system-upgrade-controller.html#components-system-upgrade-controller-helm" title="22.2.2. System Upgrade Controller Helm installation">Section 22.2.2, “System Upgrade Controller Helm installation”</a>)</p></li></ul></div><section class="sect2" id="components-system-upgrade-controller-fleet" data-id-title="System Upgrade Controller Fleet installation"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">22.2.1 </span><span class="title-name">System Upgrade Controller Fleet installation</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-fleet">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>Using Fleet, there are two possible resources that can be used to deploy SUC:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><a class="link" href="https://fleet.rancher.io/ref-gitrepo" target="_blank">GitRepo</a> resource - for use cases where an external/local Git server is available. For installation instructions, see System Upgrade Controller installation - GitRepo (<a class="xref" href="components-system-upgrade-controller.html#components-system-upgrade-controller-fleet-gitrepo" title="22.2.1.1. System Upgrade Controller installation - GitRepo">Section 22.2.1.1, “System Upgrade Controller installation - GitRepo”</a>).</p></li><li class="listitem"><p><a class="link" href="https://fleet.rancher.io/bundle-add" target="_blank">Bundle</a> resource - for air-gapped use cases that do not support a local Git server option. For installation instructions, see System Upgrade Controller installation - Bundle (<a class="xref" href="components-system-upgrade-controller.html#components-system-upgrade-controller-fleet-bundle" title="22.2.1.2. System Upgrade Controller installation - Bundle">Section 22.2.1.2, “System Upgrade Controller installation - Bundle”</a>).</p></li></ul></div><section class="sect3" id="components-system-upgrade-controller-fleet-gitrepo" data-id-title="System Upgrade Controller installation - GitRepo"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">22.2.1.1 </span><span class="title-name">System Upgrade Controller installation - GitRepo</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-fleet-gitrepo">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div id="id-1.4.20.5.8.4.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>This process can also be done through the Rancher UI, if such is available. For more information, see <a class="link" href="https://ranchermanager.docs.rancher.com/v2.12/integrations-in-rancher/fleet/overview#accessing-fleet-in-the-rancher-ui" target="_blank">Accessing Fleet in the Rancher UI</a>.</p></div><p>In your <span class="strong"><strong>management</strong></span> cluster:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Determine on which clusters you want to deploy SUC. This is done by deploying a SUC <code class="literal">GitRepo</code> resource in the correct Fleet workspace on your <span class="strong"><strong>management</strong></span> cluster. By default, Fleet has two workspaces:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><code class="literal">fleet-local</code> - for resources that need to be deployed on the <span class="strong"><strong>management</strong></span> cluster.</p></li><li class="listitem"><p><code class="literal">fleet-default</code> - for resources that need to be deployed on <span class="strong"><strong>downstream</strong></span> clusters.</p><p>For more information on Fleet workspaces, see the <a class="link" href="https://fleet.rancher.io/namespaces#gitrepos-bundles-clusters-clustergroups" target="_blank">upstream</a> documentation.</p></li></ul></div></li><li class="listitem"><p>Deploy the <code class="literal">GitRepo</code> resource:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>To deploy SUC on your management cluster:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl apply -n fleet-local -f - &lt;&lt;EOF
apiVersion: fleet.cattle.io/v1alpha1
kind: GitRepo
metadata:
  name: system-upgrade-controller
spec:
  revision: release-3.4.0
  paths:
  - fleets/day2/system-upgrade-controller
  repo: https://github.com/suse-edge/fleet-examples.git
EOF</pre></div></li><li class="listitem"><p>To deploy SUC on your downstream clusters:</p><div id="id-1.4.20.5.8.4.4.2.2.2.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>Before deploying the resource below, you <span class="strong"><strong>must</strong></span> provide a valid <code class="literal">targets</code> configuration, so that Fleet knows on which downstream clusters to deploy your resource. For information on how to map to downstream clusters, see <a class="link" href="https://fleet.rancher.io/gitrepo-targets" target="_blank">Mapping to Downstream Clusters</a>.</p></div><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl apply -n fleet-default -f - &lt;&lt;EOF
apiVersion: fleet.cattle.io/v1alpha1
kind: GitRepo
metadata:
  name: system-upgrade-controller
spec:
  revision: release-3.4.0
  paths:
  - fleets/day2/system-upgrade-controller
  repo: https://github.com/suse-edge/fleet-examples.git
  targets:
  - clusterSelector: CHANGEME
  # Example matching all clusters:
  # targets:
  # - clusterSelector: {}
EOF</pre></div></li></ul></div></li><li class="listitem"><p>Validate that the <code class="literal">GitRepo</code> resource is deployed:</p><div class="verbatim-wrap highlight bash"><pre class="screen"># Namespace will vary based on where you want to deploy SUC
kubectl get gitrepo system-upgrade-controller -n &lt;fleet-local/fleet-default&gt;

NAME                        REPO                                              COMMIT          BUNDLEDEPLOYMENTS-READY   STATUS
system-upgrade-controller   https://github.com/suse-edge/fleet-examples.git   release-3.4.0   1/1</pre></div></li><li class="listitem"><p>Validate the System Upgrade Controller deployment:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get deployment system-upgrade-controller -n cattle-system
NAME                        READY   UP-TO-DATE   AVAILABLE   AGE
system-upgrade-controller   1/1     1            1           2m20s</pre></div></li></ol></div></section><section class="sect3" id="components-system-upgrade-controller-fleet-bundle" data-id-title="System Upgrade Controller installation - Bundle"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">22.2.1.2 </span><span class="title-name">System Upgrade Controller installation - Bundle</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-fleet-bundle">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>This section illustrates how to build and deploy a <code class="literal">Bundle</code> resource from a standard Fleet configuration using the <a class="link" href="https://fleet.rancher.io/cli/fleet-cli/fleet" target="_blank">fleet-cli</a>.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>On a machine with network access download the <code class="literal">fleet-cli</code>:</p><div id="id-1.4.20.5.8.5.3.1.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>Make sure that the version of the fleet-cli you download matches the version of Fleet that has been deployed on your cluster.</p></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>For Mac users there is a <a class="link" href="https://formulae.brew.sh/formula/fleet-cli" target="_blank">fleet-cli</a> Homebrew Formulae.</p></li><li class="listitem"><p>For Linux and Windows users the binaries are present as <span class="strong"><strong>assets</strong></span> to each Fleet <a class="link" href="https://github.com/rancher/fleet/releases" target="_blank">release</a>.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Linux AMD:</p><div class="verbatim-wrap highlight bash"><pre class="screen">curl -L -o fleet-cli https://github.com/rancher/fleet/releases/download/v0.13.1/fleet-linux-amd64</pre></div></li><li class="listitem"><p>Linux ARM:</p><div class="verbatim-wrap highlight bash"><pre class="screen">curl -L -o fleet-cli https://github.com/rancher/fleet/releases/download/v0.13.1/fleet-linux-arm64</pre></div></li></ul></div></li></ul></div></li><li class="listitem"><p>Make <code class="literal">fleet-cli</code> executable:</p><div class="verbatim-wrap highlight bash"><pre class="screen">chmod +x fleet-cli</pre></div></li><li class="listitem"><p>Clone the <code class="literal">suse-edge/fleet-examples</code> <a class="link" href="https://github.com/suse-edge/fleet-examples/releases" target="_blank">release</a> that you wish to use:</p><div class="verbatim-wrap highlight bash"><pre class="screen">git clone -b release-3.4.0 https://github.com/suse-edge/fleet-examples.git</pre></div></li><li class="listitem"><p>Navigate to the SUC fleet, located in the <code class="literal">fleet-examples</code> repo:</p><div class="verbatim-wrap highlight bash"><pre class="screen">cd fleet-examples/fleets/day2/system-upgrade-controller</pre></div></li><li class="listitem"><p>Determine on which clusters you want to deploy SUC. This is done by deploying the SUC Bundle in the correct Fleet workspace inside your management cluster. By default, Fleet has two workspaces:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><code class="literal">fleet-local</code> - for resources that need to be deployed on the <span class="strong"><strong>management</strong></span> cluster.</p></li><li class="listitem"><p><code class="literal">fleet-default</code> - for resources that need to be deployed on <span class="strong"><strong>downstream</strong></span> clusters.</p><p>For more information on Fleet workspaces, see the <a class="link" href="https://fleet.rancher.io/namespaces#gitrepos-bundles-clusters-clustergroups" target="_blank">upstream</a> documentation.</p></li></ul></div></li><li class="listitem"><p>If you intend to deploy SUC only on downstream clusters, create a <code class="literal">targets.yaml</code> file that matches the specific clusters:</p><div class="verbatim-wrap highlight bash"><pre class="screen">cat &gt; targets.yaml &lt;&lt;EOF
targets:
- clusterSelector: CHANGEME
EOF</pre></div><p>For information on how to map to downstream clusters, see <a class="link" href="https://fleet.rancher.io/gitrepo-targets" target="_blank">Mapping to Downstream Clusters</a></p></li><li class="listitem"><p>Proceed to building the Bundle:</p><div id="id-1.4.20.5.8.5.3.7.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>Make sure you did <span class="strong"><strong>not</strong></span> download the fleet-cli in the <code class="literal">fleet-examples/fleets/day2/system-upgrade-controller</code> directory, otherwise it will be packaged with the Bundle, which is not advised.</p></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>To deploy SUC on your management cluster, execute:</p><div class="verbatim-wrap highlight bash"><pre class="screen">fleet-cli apply --compress -n fleet-local -o - system-upgrade-controller . &gt; system-upgrade-controller-bundle.yaml</pre></div></li><li class="listitem"><p>To deploy SUC on your downstream clusters, execute:</p><div class="verbatim-wrap highlight bash"><pre class="screen">fleet-cli apply --compress --targets-file=targets.yaml -n fleet-default -o - system-upgrade-controller . &gt; system-upgrade-controller-bundle.yaml</pre></div><p>For more information about this process, see <a class="link" href="https://fleet.rancher.io/bundle-add#convert-a-helm-chart-into-a-bundle" target="_blank">Convert a Helm Chart into a Bundle</a>.</p><p>For more information about the <code class="literal">fleet-cli apply</code> command, see <a class="link" href="https://fleet.rancher.io/cli/fleet-cli/fleet_apply" target="_blank">fleet apply</a>.</p></li></ul></div></li><li class="listitem"><p>Transfer the <code class="literal">system-upgrade-controller-bundle.yaml</code> bundle to your management cluster machine:</p><div class="verbatim-wrap highlight bash"><pre class="screen">scp system-upgrade-controller-bundle.yaml &lt;machine-address&gt;:&lt;filesystem-path&gt;</pre></div></li><li class="listitem"><p>On your management cluster, deploy the <code class="literal">system-upgrade-controller-bundle.yaml</code> Bundle:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl apply -f system-upgrade-controller-bundle.yaml</pre></div></li><li class="listitem"><p>On your management cluster, validate that the Bundle is deployed:</p><div class="verbatim-wrap highlight bash"><pre class="screen"># Namespace will vary based on where you want to deploy SUC
kubectl get bundle system-upgrade-controller -n &lt;fleet-local/fleet-default&gt;

NAME                        BUNDLEDEPLOYMENTS-READY   STATUS
system-upgrade-controller   1/1</pre></div></li><li class="listitem"><p>Based on the Fleet workspace that you deployed your Bundle to, navigate to the cluster and validate the SUC deployment:</p><div id="id-1.4.20.5.8.5.3.11.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>SUC is always deployed in the <span class="strong"><strong>cattle-system</strong></span> namespace.</p></div><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get deployment system-upgrade-controller -n cattle-system
NAME                        READY   UP-TO-DATE   AVAILABLE   AGE
system-upgrade-controller   1/1     1            1           111s</pre></div></li></ol></div></section></section><section class="sect2" id="components-system-upgrade-controller-helm" data-id-title="System Upgrade Controller Helm installation"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">22.2.2 </span><span class="title-name">System Upgrade Controller Helm installation</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-helm">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Add the Rancher chart repository:</p><div class="verbatim-wrap highlight bash"><pre class="screen">helm repo add rancher-charts https://charts.rancher.io/</pre></div></li><li class="listitem"><p>Deploy the SUC chart:</p><div class="verbatim-wrap highlight bash"><pre class="screen">helm install system-upgrade-controller rancher-charts/system-upgrade-controller --version 107.0.0 --set global.cattle.psp.enabled=false -n cattle-system --create-namespace</pre></div><p>This will install SUC version 0.16.0 which is needed by the Edge 3.4 platform.</p></li><li class="listitem"><p>Validate the SUC deployment:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get deployment system-upgrade-controller -n cattle-system
NAME                        READY   UP-TO-DATE   AVAILABLE   AGE
system-upgrade-controller   1/1     1            1           37s</pre></div></li></ol></div></section></section><section class="sect1" id="components-system-upgrade-controller-monitor-plans" data-id-title="Monitoring System Upgrade Controller Plans"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">22.3 </span><span class="title-name">Monitoring System Upgrade Controller Plans</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-monitor-plans">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>SUC Plans can be viewed in the following ways:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Through the Rancher UI (<a class="xref" href="components-system-upgrade-controller.html#components-system-upgrade-controller-monitor-plans-rancher" title="22.3.1. Monitoring System Upgrade Controller Plans - Rancher UI">Section 22.3.1, “Monitoring System Upgrade Controller Plans - Rancher UI”</a>).</p></li><li class="listitem"><p>Through manual monitoring (<a class="xref" href="components-system-upgrade-controller.html#components-system-upgrade-controller-monitor-plans-manual" title="22.3.2. Monitoring System Upgrade Controller Plans - Manual">Section 22.3.2, “Monitoring System Upgrade Controller Plans - Manual”</a>) inside of the cluster.</p></li></ul></div><div id="id-1.4.20.6.4" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important</div><p>Pods deployed for SUC Plans are kept alive <span class="strong"><strong>15</strong></span> minutes after a successful execution. After that they are removed by the corresponding Job that created them. To have access to the Pod’s logs after this time period, you should enable logging for your cluster. For information on how to do this in Rancher, see <a class="link" href="https://ranchermanager.docs.rancher.com/v2.12/integrations-in-rancher/logging" target="_blank">Rancher Integration with Logging Services</a>.</p></div><section class="sect2" id="components-system-upgrade-controller-monitor-plans-rancher" data-id-title="Monitoring System Upgrade Controller Plans - Rancher UI"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">22.3.1 </span><span class="title-name">Monitoring System Upgrade Controller Plans - Rancher UI</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-monitor-plans-rancher">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>To check Pod logs for the specific SUC plan:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>In the upper left corner, <span class="strong"><strong>☰ → &lt;your-cluster-name&gt;</strong></span></p></li><li class="listitem"><p>Select Workloads → Pods</p></li><li class="listitem"><p>Select the <code class="literal">Only User Namespaces</code> drop down menu and add the <code class="literal">cattle-system</code> namespace</p></li><li class="listitem"><p>In the Pod filter bar, write the name for your SUC Plan Pod. The name will be in the following template format: <code class="literal">apply-&lt;plan_name&gt;-on-&lt;node_name&gt;</code></p><div id="id-1.4.20.6.5.3.4.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>There may be both <code class="literal">Completed</code> and <code class="literal">Unknown</code> Pods for a specific SUC Plan. This is expected and happens due to the nature of some of the upgrades.</p></div></li><li class="listitem"><p>Select the pod that you want to review the logs of and navigate to <span class="strong"><strong>⋮ → View Logs</strong></span></p></li></ol></div></section><section class="sect2" id="components-system-upgrade-controller-monitor-plans-manual" data-id-title="Monitoring System Upgrade Controller Plans - Manual"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">22.3.2 </span><span class="title-name">Monitoring System Upgrade Controller Plans - Manual</span></span> <a title="Permalink" class="permalink" href="components-system-upgrade-controller.html#components-system-upgrade-controller-monitor-plans-manual">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div id="id-1.4.20.6.6.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>The below steps assume that <code class="literal">kubectl</code> has been configured to connect to the cluster where the <span class="strong"><strong>SUC Plans</strong></span> have been deployed to.</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>List deployed <span class="strong"><strong>SUC</strong></span> Plans:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get plans -n cattle-system</pre></div></li><li class="listitem"><p>Get Pod for <span class="strong"><strong>SUC</strong></span> Plan:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get pods -l upgrade.cattle.io/plan=&lt;plan_name&gt; -n cattle-system</pre></div><div id="id-1.4.20.6.6.3.2.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>There may be both <code class="literal">Completed</code> and <code class="literal">Unknown</code> Pods for a specific SUC Plan. This is expected and happens due to the nature of some of the upgrades.</p></div></li><li class="listitem"><p>Get logs for the Pod:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl logs &lt;pod_name&gt; -n cattle-system</pre></div></li></ol></div></section></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="components-kubevirt.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 21 </span>Edge Virtualization</span></a> </div><div><a class="pagination-link next" href="components-upgrade-controller.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 23 </span>Upgrade Controller</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="section"><a href="components-system-upgrade-controller.html#id-how-does-suse-edge-use-system-upgrade-controller"><span class="title-number">22.1 </span><span class="title-name">How does SUSE Edge use System Upgrade Controller?</span></a></span></li><li><span class="section"><a href="components-system-upgrade-controller.html#components-system-upgrade-controller-install"><span class="title-number">22.2 </span><span class="title-name">Installing the System Upgrade Controller</span></a></span></li><li><span class="section"><a href="components-system-upgrade-controller.html#components-system-upgrade-controller-monitor-plans"><span class="title-number">22.3 </span><span class="title-name">Monitoring System Upgrade Controller Plans</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2025</span></div></div></footer></body></html>