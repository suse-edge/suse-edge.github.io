<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SUSE Edge Documentation | NATS</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="NATS"/>
<meta name="description" content="NATS is a connective technology built for the ever-increasingly hyper-connected world. It is a single technology that enables applications to securel…"/>
<meta name="book-title" content="SUSE Edge Documentation"/>
<meta name="chapter-title" content="Chapter 33. NATS"/>
<meta name="tracker-url" content="https://github.com/suse-edge/suse-edge.github.io/issues/new"/>
<meta name="tracker-type" content="gh"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="NATS"/>
<meta property="og:description" content="NATS is a connective technology built for the ever-increasi…"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="NATS"/>
<meta name="twitter:description" content="NATS is a connective technology built for the ever-increasi…"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    

    "headline": "NATS",
  
    "description": "NATS",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="id-third-party-integration.html" title="Part V. Third-Party Integration"/><link rel="next" href="id-nvidia-gpus-on-suse-linux-micro.html" title="Chapter 34. NVIDIA GPUs on SUSE Linux Micro"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="wide offline js-off"><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">SUSE Edge Documentation</a><span> / </span><a class="crumb" href="id-third-party-integration.html">Third-Party Integration</a><span> / </span><a class="crumb" href="integrations-nats.html">NATS</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">SUSE Edge Documentation</div><ol><li><a href="suse-edge-documentation.html" class=" "><span class="title-number"> </span><span class="title-name">SUSE Edge 3.4 Documentation</span></a></li><li><a href="id-quick-starts.html" class="has-children "><span class="title-number">I </span><span class="title-name">Quick Starts</span></a><ol><li><a href="quickstart-metal3.html" class=" "><span class="title-number">1 </span><span class="title-name">BMC automated deployments with Metal<sup>3</sup></span></a></li><li><a href="quickstart-elemental.html" class=" "><span class="title-number">2 </span><span class="title-name">Remote host onboarding with Elemental</span></a></li><li><a href="quickstart-eib.html" class=" "><span class="title-number">3 </span><span class="title-name">Standalone clusters with Edge Image Builder</span></a></li><li><a href="quickstart-suma.html" class=" "><span class="title-number">4 </span><span class="title-name">SUSE Multi-Linux Manager</span></a></li></ol></li><li><a href="id-components.html" class="has-children "><span class="title-number">II </span><span class="title-name">Components</span></a><ol><li><a href="components-rancher.html" class=" "><span class="title-number">5 </span><span class="title-name">Rancher</span></a></li><li><a href="components-rancher-dashboard-extensions.html" class=" "><span class="title-number">6 </span><span class="title-name">Rancher Dashboard Extensions</span></a></li><li><a href="components-rancher-turtles.html" class=" "><span class="title-number">7 </span><span class="title-name">Rancher Turtles</span></a></li><li><a href="components-fleet.html" class=" "><span class="title-number">8 </span><span class="title-name">Fleet</span></a></li><li><a href="components-slmicro.html" class=" "><span class="title-number">9 </span><span class="title-name">SUSE Linux Micro</span></a></li><li><a href="components-metal3.html" class=" "><span class="title-number">10 </span><span class="title-name">Metal<sup>3</sup></span></a></li><li><a href="components-eib.html" class=" "><span class="title-number">11 </span><span class="title-name">Edge Image Builder</span></a></li><li><a href="components-nmc.html" class=" "><span class="title-number">12 </span><span class="title-name">Edge Networking</span></a></li><li><a href="components-elemental.html" class=" "><span class="title-number">13 </span><span class="title-name">Elemental</span></a></li><li><a href="components-akri.html" class=" "><span class="title-number">14 </span><span class="title-name">Akri</span></a></li><li><a href="components-k3s.html" class=" "><span class="title-number">15 </span><span class="title-name">K3s</span></a></li><li><a href="components-rke2.html" class=" "><span class="title-number">16 </span><span class="title-name">RKE2</span></a></li><li><a href="components-suse-storage.html" class=" "><span class="title-number">17 </span><span class="title-name">SUSE Storage</span></a></li><li><a href="components-suse-security.html" class=" "><span class="title-number">18 </span><span class="title-name">SUSE Security</span></a></li><li><a href="components-metallb.html" class=" "><span class="title-number">19 </span><span class="title-name">MetalLB</span></a></li><li><a href="components-eco.html" class=" "><span class="title-number">20 </span><span class="title-name">Endpoint Copier Operator</span></a></li><li><a href="components-kubevirt.html" class=" "><span class="title-number">21 </span><span class="title-name">Edge Virtualization</span></a></li><li><a href="components-system-upgrade-controller.html" class=" "><span class="title-number">22 </span><span class="title-name">System Upgrade Controller</span></a></li><li><a href="components-upgrade-controller.html" class=" "><span class="title-number">23 </span><span class="title-name">Upgrade Controller</span></a></li><li><a href="components-suma.html" class=" "><span class="title-number">24 </span><span class="title-name">SUSE Multi-Linux Manager</span></a></li></ol></li><li><a href="id-how-to-guides.html" class="has-children "><span class="title-number">III </span><span class="title-name">How-To Guides</span></a><ol><li><a href="guides-metallb-k3s.html" class=" "><span class="title-number">25 </span><span class="title-name">MetalLB on K3s (using Layer 2 Mode)</span></a></li><li><a href="guides-metallb-k3s-l3.html" class=" "><span class="title-number">26 </span><span class="title-name">MetalLB on K3s (using Layer 3 Mode)</span></a></li><li><a href="guides-metallb-kubernetes.html" class=" "><span class="title-number">27 </span><span class="title-name">MetalLB in front of the Kubernetes API server</span></a></li><li><a href="id-air-gapped-deployments-with-edge-image-builder.html" class=" "><span class="title-number">28 </span><span class="title-name">Air-gapped deployments with Edge Image Builder</span></a></li><li><a href="guides-kiwi-builder-images.html" class=" "><span class="title-number">29 </span><span class="title-name">Building Updated SUSE Linux Micro Images with Kiwi</span></a></li><li><a href="guides-clusterclass-example.html" class=" "><span class="title-number">30 </span><span class="title-name">Using clusterclass to deploy downstream clusters</span></a></li></ol></li><li><a href="tips-and-tricks.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Tips and Tricks</span></a><ol><li><a href="tips-edge-image-builder.html" class=" "><span class="title-number">31 </span><span class="title-name">Edge Image Builder</span></a></li><li><a href="tips-elemental.html" class=" "><span class="title-number">32 </span><span class="title-name">Elemental</span></a></li></ol></li><li class="active"><a href="id-third-party-integration.html" class="has-children you-are-here"><span class="title-number">V </span><span class="title-name">Third-Party Integration</span></a><ol><li><a href="integrations-nats.html" class=" you-are-here"><span class="title-number">33 </span><span class="title-name">NATS</span></a></li><li><a href="id-nvidia-gpus-on-suse-linux-micro.html" class=" "><span class="title-number">34 </span><span class="title-name">NVIDIA GPUs on SUSE Linux Micro</span></a></li></ol></li><li><a href="day-2-operations.html" class="has-children "><span class="title-number">VI </span><span class="title-name">Day 2 Operations</span></a><ol><li><a href="day2-migration.html" class=" "><span class="title-number">35 </span><span class="title-name">Edge 3.4 migration</span></a></li><li><a href="day2-mgmt-cluster.html" class=" "><span class="title-number">36 </span><span class="title-name">Management Cluster</span></a></li><li><a href="day2-downstream-clusters.html" class=" "><span class="title-number">37 </span><span class="title-name">Downstream clusters</span></a></li></ol></li><li><a href="id-suse-telco-cloud-documentation.html" class="has-children "><span class="title-number">VII </span><span class="title-name">SUSE Telco Cloud Documentation</span></a><ol><li><a href="atip.html" class=" "><span class="title-number">38 </span><span class="title-name">SUSE Telco Cloud</span></a></li><li><a href="atip-architecture.html" class=" "><span class="title-number">39 </span><span class="title-name">Concept &amp; Architecture</span></a></li><li><a href="atip-requirements.html" class=" "><span class="title-number">40 </span><span class="title-name">Requirements &amp; Assumptions</span></a></li><li><a href="atip-management-cluster.html" class=" "><span class="title-number">41 </span><span class="title-name">Setting up the management cluster</span></a></li><li><a href="atip-features.html" class=" "><span class="title-number">42 </span><span class="title-name">Telco features configuration</span></a></li><li><a href="atip-automated-provisioning.html" class=" "><span class="title-number">43 </span><span class="title-name">Fully automated directed network provisioning</span></a></li><li><a href="atip-lifecycle.html" class=" "><span class="title-number">44 </span><span class="title-name">Lifecycle actions</span></a></li></ol></li><li><a href="id-troubleshooting-3.html" class="has-children "><span class="title-number">VIII </span><span class="title-name">Troubleshooting</span></a><ol><li><a href="general-troubleshooting-principles.html" class=" "><span class="title-number">45 </span><span class="title-name">General Troubleshooting Principles</span></a></li><li><a href="troubleshooting-kiwi.html" class=" "><span class="title-number">46 </span><span class="title-name">Troubleshooting Kiwi</span></a></li><li><a href="troubleshooting-edge-image-builder.html" class=" "><span class="title-number">47 </span><span class="title-name">Troubleshooting Edge Image Builder (EIB)</span></a></li><li><a href="troubleshooting-edge-networking.html" class=" "><span class="title-number">48 </span><span class="title-name">Troubleshooting Edge Networking (NMC)</span></a></li><li><a href="troubleshooting-phone-home-scenarios.html" class=" "><span class="title-number">49 </span><span class="title-name">Troubleshooting Phone-Home scenarios</span></a></li><li><a href="troubleshooting-directed-network-provisioning.html" class=" "><span class="title-number">50 </span><span class="title-name">Troubleshooting Directed-network provisioning</span></a></li><li><a href="troubleshooting-other-components.html" class=" "><span class="title-number">51 </span><span class="title-name">Troubleshooting Other components</span></a></li><li><a href="collecting-diagnostics-for-support.html" class=" "><span class="title-number">52 </span><span class="title-name">Collecting Diagnostics for Support</span></a></li></ol></li><li><a href="id-appendix.html" class="has-children "><span class="title-number">IX </span><span class="title-name">Appendix</span></a><ol><li><a href="id-release-notes.html" class=" "><span class="title-number">53 </span><span class="title-name">Release Notes</span></a></li></ol></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="integrations-nats" data-id-title="NATS"><div class="titlepage"><div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">33 </span><span class="title-name">NATS</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p><a class="link" href="https://nats.io/" target="_blank">NATS</a> is a connective technology built for the ever-increasingly hyper-connected world. It is a single technology that enables applications to securely communicate across any combination of cloud vendors, on-premises, edge, Web and mobile devices. NATS consists of a family of open-source products that are tightly integrated but can be deployed easily and independently. NATS is being used globally by thousands of companies, spanning use cases including microservices, edge computing, mobile and IoT, and can be used to augment or replace traditional messaging.</p><section class="sect1" id="id-architecture" data-id-title="Architecture"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">33.1 </span><span class="title-name">Architecture</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#id-architecture">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>NATS is an infrastructure that allows data exchange between applications in the form of messages.</p><section class="sect2" id="id-nats-client-applications" data-id-title="NATS client applications"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">33.1.1 </span><span class="title-name">NATS client applications</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#id-nats-client-applications">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>NATS client libraries can be used to allow the applications to publish, subscribe, request and reply between different instances.
These applications are generally referred to as <code class="literal">client applications</code>.</p></section><section class="sect2" id="id-nats-service-infrastructure" data-id-title="NATS service infrastructure"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">33.1.2 </span><span class="title-name">NATS service infrastructure</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#id-nats-service-infrastructure">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>The NATS services are provided by one or more NATS server processes that are configured to interconnect with each other and provide a NATS service infrastructure. The NATS service infrastructure can scale from a single NATS server process running on an end device to a public global super-cluster of many clusters spanning all major cloud providers and all regions of the world.</p></section><section class="sect2" id="id-simple-messaging-design" data-id-title="Simple messaging design"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">33.1.3 </span><span class="title-name">Simple messaging design</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#id-simple-messaging-design">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>NATS makes it easy for applications to communicate by sending and receiving messages. These messages are addressed and identified by subject strings and do not depend on network location.
Data is encoded and framed as a message and sent by a publisher. The message is received, decoded and processed by one or more subscribers.</p></section><section class="sect2" id="id-nats-jetstream" data-id-title="NATS JetStream"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">33.1.4 </span><span class="title-name">NATS JetStream</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#id-nats-jetstream">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>NATS has a built-in distributed persistence system called JetStream.
JetStream was created to solve the problems identified with streaming in technology today — complexity, fragility and a lack of scalability. JetStream also solves the problem with the coupling of the publisher and the subscriber (the subscribers need to be up and running to receive the message when it is published).
More information about NATS JetStream can be found <a class="link" href="https://docs.nats.io/nats-concepts/jetstream" target="_blank">here</a>.</p></section></section><section class="sect1" id="id-installation-5" data-id-title="Installation"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">33.2 </span><span class="title-name">Installation</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#id-installation-5">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><section class="sect2" id="id-installing-nats-on-top-of-k3s" data-id-title="Installing NATS on top of K3s"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">33.2.1 </span><span class="title-name">Installing NATS on top of K3s</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#id-installing-nats-on-top-of-k3s">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>NATS is built for multiple architectures so it can easily be installed on K3s. (<a class="xref" href="components-k3s.html" title="Chapter 15. K3s">Chapter 15, <em>K3s</em></a>)</p><p>Let us create a values file to overwrite the default values of NATS.</p><div class="verbatim-wrap highlight yaml"><pre class="screen">cat &gt; values.yaml &lt;&lt;EOF
cluster:
  # Enable the HA setup of the NATS
  enabled: true
  replicas: 3

nats:
  jetstream:
    # Enable JetStream
    enabled: true

    memStorage:
      enabled: true
      size: 2Gi

    fileStorage:
      enabled: true
      size: 1Gi
      storageDirectory: /data/
EOF</pre></div><p>Now let us install NATS via Helm:</p><div class="verbatim-wrap highlight bash"><pre class="screen">helm repo add nats https://nats-io.github.io/k8s/helm/charts/
helm install nats nats/nats --namespace nats --values values.yaml \
 --create-namespace</pre></div><p>With the <code class="literal">values.yaml</code> file above, the following components will be in the <code class="literal">nats</code> namespace:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>HA version of NATS Statefulset containing three containers: NATS server + Config reloader and Metrics sidecars.</p></li><li class="listitem"><p>NATS box container, which comes with a set of <code class="literal">NATS</code> utilities that can be used to verify the setup.</p></li><li class="listitem"><p>JetStream also leverages its Key-Value back-end that comes with <code class="literal">PVCs</code> bounded to the pods.</p></li></ol></div><section class="sect3" id="id-testing-the-setup" data-id-title="Testing the setup"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">33.2.1.1 </span><span class="title-name">Testing the setup</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#id-testing-the-setup">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl exec -n nats -it deployment/nats-box -- /bin/sh -l</pre></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Create a subscription for the test subject:</p><div class="verbatim-wrap highlight bash"><pre class="screen">nats sub test &amp;</pre></div></li><li class="listitem"><p>Send a message to the test subject:</p><div class="verbatim-wrap highlight bash"><pre class="screen">nats pub test hi</pre></div></li></ol></div></section><section class="sect3" id="id-cleaning-up" data-id-title="Cleaning up"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">33.2.1.2 </span><span class="title-name">Cleaning up</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#id-cleaning-up">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="verbatim-wrap highlight bash"><pre class="screen">helm -n nats uninstall nats
rm values.yaml</pre></div></section></section><section class="sect2" id="id-nats-as-a-back-end-for-k3s" data-id-title="NATS as a back-end for K3s"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">33.2.2 </span><span class="title-name">NATS as a back-end for K3s</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#id-nats-as-a-back-end-for-k3s">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>One component K3s leverages is <a class="link" href="https://github.com/k3s-io/kine" target="_blank">KINE</a>, which is a shim enabling the replacement of etcd with alternate storage back-ends originally targeting relational databases.
As JetStream provides a Key Value API, this makes it possible to have NATS as a back-end for the K3s cluster.</p><p>There is an already merged PR which makes the built-in NATS in K3s straightforward, but the change is still <a class="link" href="https://github.com/k3s-io/k3s/issues/7410#issue-1692989394" target="_blank">not included</a> in the K3s releases.</p><p>For this reason, the K3s binary should be built manually.</p><section class="sect3" id="id-building-k3s" data-id-title="Building K3s"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">33.2.2.1 </span><span class="title-name">Building K3s</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#id-building-k3s">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="verbatim-wrap highlight bash"><pre class="screen">git clone --depth 1 https://github.com/k3s-io/k3s.git &amp;&amp; cd k3s</pre></div><p>The following command adds <code class="literal">nats</code> in the build tags to enable the NATS built-in feature in K3s:</p><div class="verbatim-wrap highlight bash"><pre class="screen">sed -i '' 's/TAGS="ctrd/TAGS="nats ctrd/g' scripts/build
make local</pre></div><p>Replace &lt;node-ip&gt; with the actual IP of the node where the K3s will be started:</p><div class="verbatim-wrap highlight bash"><pre class="screen">export NODE_IP=&lt;node-ip&gt;
sudo scp dist/artifacts/k3s-arm64 ${NODE_IP}:/usr/local/bin/k3s</pre></div><div id="id-1.7.3.4.3.5.7" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>Locally building K3s requires the buildx Docker CLI plugin.
It can be <a class="link" href="https://github.com/docker/buildx#manual-download" target="_blank">manually installed</a> if <code class="literal">$ make local</code> fails.</p></div></section><section class="sect3" id="id-installing-nats-cli" data-id-title="Installing NATS CLI"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">33.2.2.2 </span><span class="title-name">Installing NATS CLI</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#id-installing-nats-cli">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="verbatim-wrap highlight bash"><pre class="screen">TMPDIR=$(mktemp -d)
nats_version="nats-0.0.35-linux-arm64"
curl -o "${TMPDIR}/nats.zip" -sfL https://github.com/nats-io/natscli/releases/download/v0.0.35/${nats_version}.zip
unzip "${TMPDIR}/nats.zip" -d "${TMPDIR}"

sudo scp ${TMPDIR}/${nats_version}/nats ${NODE_IP}:/usr/local/bin/nats
rm -rf ${TMPDIR}</pre></div></section><section class="sect3" id="id-running-nats-as-k3s-back-end" data-id-title="Running NATS as K3s back-end"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">33.2.2.3 </span><span class="title-name">Running NATS as K3s back-end</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#id-running-nats-as-k3s-back-end">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>Let us <code class="literal">ssh</code> on the node and run the K3s with the <code class="literal">--datastore-endpoint</code> flag pointing to <code class="literal">nats</code>.</p><div id="id-1.7.3.4.3.7.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>The command below starts K3s as a foreground process, so the logs can be easily followed to see if there are any issues.
To not block the current terminal, a <code class="literal">&amp;</code> flag could be added before the command to start it as a background process.</p></div><div class="verbatim-wrap highlight bash"><pre class="screen">k3s server  --datastore-endpoint=nats://</pre></div><div id="id-1.7.3.4.3.7.5" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>For making the K3s server with the NATS back-end permanent on your <code class="literal">slemicro</code> VM, the script below can be run, which creates a <code class="literal">systemd</code> service with the needed configurations.</p></div><div class="verbatim-wrap highlight bash"><pre class="screen">export INSTALL_K3S_SKIP_START=false
export INSTALL_K3S_SKIP_DOWNLOAD=true

curl -sfL https://get.k3s.io | INSTALL_K3S_EXEC="server \
 --datastore-endpoint=nats://"  sh -</pre></div></section><section class="sect3" id="id-troubleshooting-2" data-id-title="Troubleshooting"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">33.2.2.4 </span><span class="title-name">Troubleshooting</span></span> <a title="Permalink" class="permalink" href="integrations-nats.html#id-troubleshooting-2">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>The following commands can be run on the node to verify that everything with the stream works properly:</p><div class="verbatim-wrap highlight bash"><pre class="screen">nats str report -a
nats str view -a</pre></div></section></section></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="id-third-party-integration.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Part V </span>Third-Party Integration</span></a> </div><div><a class="pagination-link next" href="id-nvidia-gpus-on-suse-linux-micro.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 34 </span>NVIDIA GPUs on SUSE Linux Micro</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="section"><a href="integrations-nats.html#id-architecture"><span class="title-number">33.1 </span><span class="title-name">Architecture</span></a></span></li><li><span class="section"><a href="integrations-nats.html#id-installation-5"><span class="title-number">33.2 </span><span class="title-name">Installation</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2025</span></div></div></footer></body></html>