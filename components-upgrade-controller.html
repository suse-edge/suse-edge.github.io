<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SUSE Edge Documentation | Upgrade Controller</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Upgrade Controller"/>
<meta name="description" content="A Kubernetes controller capable of performing upgrades over the following SUSE Edge platform components:"/>
<meta name="book-title" content="SUSE Edge Documentation"/>
<meta name="chapter-title" content="Chapter 23. Upgrade Controller"/>
<meta name="tracker-url" content="https://github.com/suse-edge/suse-edge.github.io/issues/new"/>
<meta name="tracker-type" content="gh"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Upgrade Controller"/>
<meta property="og:description" content="A Kubernetes controller capable of performing upgrades over…"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Upgrade Controller"/>
<meta name="twitter:description" content="A Kubernetes controller capable of performing upgrades over…"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    

    "headline": "Upgrade Controller",
  
    "description": "Upgrade Controller",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="components-system-upgrade-controller.html" title="Chapter 22. System Upgrade Controller"/><link rel="next" href="components-suma.html" title="Chapter 24. SUSE Multi-Linux Manager"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="wide offline js-off"><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">SUSE Edge Documentation</a><span> / </span><a class="crumb" href="id-components.html">Components</a><span> / </span><a class="crumb" href="components-upgrade-controller.html">Upgrade Controller</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">SUSE Edge Documentation</div><ol><li><a href="suse-edge-documentation.html" class=" "><span class="title-number"> </span><span class="title-name">SUSE Edge 3.4 Documentation</span></a></li><li><a href="id-quick-starts.html" class="has-children "><span class="title-number">I </span><span class="title-name">Quick Starts</span></a><ol><li><a href="quickstart-metal3.html" class=" "><span class="title-number">1 </span><span class="title-name">BMC automated deployments with Metal<sup>3</sup></span></a></li><li><a href="quickstart-elemental.html" class=" "><span class="title-number">2 </span><span class="title-name">Remote host onboarding with Elemental</span></a></li><li><a href="quickstart-eib.html" class=" "><span class="title-number">3 </span><span class="title-name">Standalone clusters with Edge Image Builder</span></a></li><li><a href="quickstart-suma.html" class=" "><span class="title-number">4 </span><span class="title-name">SUSE Multi-Linux Manager</span></a></li></ol></li><li class="active"><a href="id-components.html" class="has-children you-are-here"><span class="title-number">II </span><span class="title-name">Components</span></a><ol><li><a href="components-rancher.html" class=" "><span class="title-number">5 </span><span class="title-name">Rancher</span></a></li><li><a href="components-rancher-dashboard-extensions.html" class=" "><span class="title-number">6 </span><span class="title-name">Rancher Dashboard Extensions</span></a></li><li><a href="components-rancher-turtles.html" class=" "><span class="title-number">7 </span><span class="title-name">Rancher Turtles</span></a></li><li><a href="components-fleet.html" class=" "><span class="title-number">8 </span><span class="title-name">Fleet</span></a></li><li><a href="components-slmicro.html" class=" "><span class="title-number">9 </span><span class="title-name">SUSE Linux Micro</span></a></li><li><a href="components-metal3.html" class=" "><span class="title-number">10 </span><span class="title-name">Metal<sup>3</sup></span></a></li><li><a href="components-eib.html" class=" "><span class="title-number">11 </span><span class="title-name">Edge Image Builder</span></a></li><li><a href="components-nmc.html" class=" "><span class="title-number">12 </span><span class="title-name">Edge Networking</span></a></li><li><a href="components-elemental.html" class=" "><span class="title-number">13 </span><span class="title-name">Elemental</span></a></li><li><a href="components-akri.html" class=" "><span class="title-number">14 </span><span class="title-name">Akri</span></a></li><li><a href="components-k3s.html" class=" "><span class="title-number">15 </span><span class="title-name">K3s</span></a></li><li><a href="components-rke2.html" class=" "><span class="title-number">16 </span><span class="title-name">RKE2</span></a></li><li><a href="components-suse-storage.html" class=" "><span class="title-number">17 </span><span class="title-name">SUSE Storage</span></a></li><li><a href="components-suse-security.html" class=" "><span class="title-number">18 </span><span class="title-name">SUSE Security</span></a></li><li><a href="components-metallb.html" class=" "><span class="title-number">19 </span><span class="title-name">MetalLB</span></a></li><li><a href="components-eco.html" class=" "><span class="title-number">20 </span><span class="title-name">Endpoint Copier Operator</span></a></li><li><a href="components-kubevirt.html" class=" "><span class="title-number">21 </span><span class="title-name">Edge Virtualization</span></a></li><li><a href="components-system-upgrade-controller.html" class=" "><span class="title-number">22 </span><span class="title-name">System Upgrade Controller</span></a></li><li><a href="components-upgrade-controller.html" class=" you-are-here"><span class="title-number">23 </span><span class="title-name">Upgrade Controller</span></a></li><li><a href="components-suma.html" class=" "><span class="title-number">24 </span><span class="title-name">SUSE Multi-Linux Manager</span></a></li></ol></li><li><a href="id-how-to-guides.html" class="has-children "><span class="title-number">III </span><span class="title-name">How-To Guides</span></a><ol><li><a href="guides-metallb-k3s.html" class=" "><span class="title-number">25 </span><span class="title-name">MetalLB on K3s (using Layer 2 Mode)</span></a></li><li><a href="guides-metallb-k3s-l3.html" class=" "><span class="title-number">26 </span><span class="title-name">MetalLB on K3s (using Layer 3 Mode)</span></a></li><li><a href="guides-metallb-kubernetes.html" class=" "><span class="title-number">27 </span><span class="title-name">MetalLB in front of the Kubernetes API server</span></a></li><li><a href="id-air-gapped-deployments-with-edge-image-builder.html" class=" "><span class="title-number">28 </span><span class="title-name">Air-gapped deployments with Edge Image Builder</span></a></li><li><a href="guides-kiwi-builder-images.html" class=" "><span class="title-number">29 </span><span class="title-name">Building Updated SUSE Linux Micro Images with Kiwi</span></a></li><li><a href="guides-clusterclass-example.html" class=" "><span class="title-number">30 </span><span class="title-name">Using clusterclass to deploy downstream clusters</span></a></li></ol></li><li><a href="tips-and-tricks.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Tips and Tricks</span></a><ol><li><a href="tips-edge-image-builder.html" class=" "><span class="title-number">31 </span><span class="title-name">Edge Image Builder</span></a></li><li><a href="tips-elemental.html" class=" "><span class="title-number">32 </span><span class="title-name">Elemental</span></a></li></ol></li><li><a href="id-third-party-integration.html" class="has-children "><span class="title-number">V </span><span class="title-name">Third-Party Integration</span></a><ol><li><a href="integrations-nats.html" class=" "><span class="title-number">33 </span><span class="title-name">NATS</span></a></li><li><a href="id-nvidia-gpus-on-suse-linux-micro.html" class=" "><span class="title-number">34 </span><span class="title-name">NVIDIA GPUs on SUSE Linux Micro</span></a></li></ol></li><li><a href="day-2-operations.html" class="has-children "><span class="title-number">VI </span><span class="title-name">Day 2 Operations</span></a><ol><li><a href="day2-migration.html" class=" "><span class="title-number">35 </span><span class="title-name">Edge 3.3 migration</span></a></li><li><a href="day2-mgmt-cluster.html" class=" "><span class="title-number">36 </span><span class="title-name">Management Cluster</span></a></li><li><a href="day2-downstream-clusters.html" class=" "><span class="title-number">37 </span><span class="title-name">Downstream clusters</span></a></li></ol></li><li><a href="id-suse-telco-cloud-documentation.html" class="has-children "><span class="title-number">VII </span><span class="title-name">SUSE Telco Cloud Documentation</span></a><ol><li><a href="atip.html" class=" "><span class="title-number">38 </span><span class="title-name">SUSE Telco Cloud</span></a></li><li><a href="atip-architecture.html" class=" "><span class="title-number">39 </span><span class="title-name">Concept &amp; Architecture</span></a></li><li><a href="atip-requirements.html" class=" "><span class="title-number">40 </span><span class="title-name">Requirements &amp; Assumptions</span></a></li><li><a href="atip-management-cluster.html" class=" "><span class="title-number">41 </span><span class="title-name">Setting up the management cluster</span></a></li><li><a href="atip-features.html" class=" "><span class="title-number">42 </span><span class="title-name">Telco features configuration</span></a></li><li><a href="atip-automated-provisioning.html" class=" "><span class="title-number">43 </span><span class="title-name">Fully automated directed network provisioning</span></a></li><li><a href="atip-lifecycle.html" class=" "><span class="title-number">44 </span><span class="title-name">Lifecycle actions</span></a></li></ol></li><li><a href="id-troubleshooting-3.html" class="has-children "><span class="title-number">VIII </span><span class="title-name">Troubleshooting</span></a><ol><li><a href="general-troubleshooting-principles.html" class=" "><span class="title-number">45 </span><span class="title-name">General Troubleshooting Principles</span></a></li><li><a href="troubleshooting-kiwi.html" class=" "><span class="title-number">46 </span><span class="title-name">Troubleshooting Kiwi</span></a></li><li><a href="troubleshooting-edge-image-builder.html" class=" "><span class="title-number">47 </span><span class="title-name">Troubleshooting Edge Image Builder (EIB)</span></a></li><li><a href="troubleshooting-edge-networking.html" class=" "><span class="title-number">48 </span><span class="title-name">Troubleshooting Edge Networking (NMC)</span></a></li><li><a href="troubleshooting-phone-home-scenarios.html" class=" "><span class="title-number">49 </span><span class="title-name">Troubleshooting Phone-Home scenarios</span></a></li><li><a href="troubleshooting-directed-network-provisioning.html" class=" "><span class="title-number">50 </span><span class="title-name">Troubleshooting Directed-network provisioning</span></a></li><li><a href="troubleshooting-other-components.html" class=" "><span class="title-number">51 </span><span class="title-name">Troubleshooting Other components</span></a></li><li><a href="collecting-diagnostics-for-support.html" class=" "><span class="title-number">52 </span><span class="title-name">Collecting Diagnostics for Support</span></a></li></ol></li><li><a href="id-appendix.html" class="has-children "><span class="title-number">IX </span><span class="title-name">Appendix</span></a><ol><li><a href="id-release-notes.html" class=" "><span class="title-number">53 </span><span class="title-name">Release Notes</span></a></li></ol></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="components-upgrade-controller" data-id-title="Upgrade Controller"><div class="titlepage"><div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">23 </span><span class="title-name">Upgrade Controller</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>A Kubernetes controller capable of performing upgrades over the following SUSE Edge platform components:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Operating System (SUSE Linux Micro)</p></li><li class="listitem"><p>Kubernetes (K3s &amp; RKE2)</p></li><li class="listitem"><p>Additional components (Rancher, Elemental, SUSE Security, etc.)</p></li></ul></div><p>The <a class="link" href="https://github.com/suse-edge/upgrade-controller" target="_blank">Upgrade Controller</a> streamlines the upgrade process for the components mentioned above by encapsulating their complexities within a single <code class="literal">user-facing</code> resource that serves as a <span class="strong"><strong>trigger</strong></span> for the upgrade. Users only need to configure this resource and the <code class="literal">Upgrade Controller</code> takes care of the rest.</p><div id="id-1.4.21.5" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>The <code class="literal">Upgrade Controller</code> currently supports SUSE Edge platform upgrades only for <span class="strong"><strong>non air-gapped management</strong></span> clusters. Refer to the <a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-known-issues" title="23.7. Known Limitations">Section 23.7, “Known Limitations”</a> section for more information.</p></div><section class="sect1" id="id-how-does-suse-edge-use-upgrade-controller" data-id-title="How does SUSE Edge use Upgrade Controller?"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.1 </span><span class="title-name">How does SUSE Edge use Upgrade Controller?</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#id-how-does-suse-edge-use-upgrade-controller">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>The <span class="strong"><strong>Upgrade Controller</strong></span> is essential in automating the (formerly manual) "Day 2" operations required to upgrade management clusters from one SUSE Edge release version to the next.</p><p>To achieve this automation, the Upgrade Controller utilizes tools such as the System Upgrade Controller (<a class="xref" href="components-system-upgrade-controller.html" title="Chapter 22. System Upgrade Controller">Chapter 22, <em>System Upgrade Controller</em></a>) and the <a class="link" href="https://github.com/k3s-io/helm-controller/" target="_blank">Helm Controller</a>.</p><p>For further details on how the Upgrade Controller works, see <a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-how" title="23.4. How does the Upgrade Controller work?">Section 23.4, “How does the Upgrade Controller work?”</a>.</p><p>For known limitations that the Upgrade Controller has, see <a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-known-issues" title="23.7. Known Limitations">Section 23.7, “Known Limitations”</a>.</p><p>For information on the difference between the Upgrade Controller and the System Upgrade Controller, see <a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-uc-vs-suc" title="23.2. Upgrade Controller vs System Upgrade Controller">Section 23.2, “Upgrade Controller vs System Upgrade Controller”</a>.</p></section><section class="sect1" id="components-upgrade-controller-uc-vs-suc" data-id-title="Upgrade Controller vs System Upgrade Controller"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.2 </span><span class="title-name">Upgrade Controller vs System Upgrade Controller</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#components-upgrade-controller-uc-vs-suc">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>The System Upgrade Controller (SUC) (<a class="xref" href="components-system-upgrade-controller.html" title="Chapter 22. System Upgrade Controller">Chapter 22, <em>System Upgrade Controller</em></a>) is a general-purpose tool that propagates upgrade instructions to specific Kubernetes nodes.</p><p>While it supports some "Day 2" operations for the SUSE Edge platform, it <span class="strong"><strong>does not</strong></span> cover all of them. Moreover, even for supported operations, users have to manually configure, maintain, and deploy multiple <code class="literal">SUC Plans</code> — an error-prone process that can lead to unexpected issues.</p><p>This led to the need for a tool that <span class="strong"><strong>automates</strong></span> and <span class="strong"><strong>abstracts</strong></span> the complexity of managing various "Day 2" operations for the SUSE Edge platform. Thus, the <code class="literal">Upgrade Controller</code> was developed. It simplifies the upgrade process by introducing a single <code class="literal">user-facing resource</code> that drives the upgrade. Users only need to manage this resource, while the <code class="literal">Upgrade Controller</code> takes care of the rest.</p></section><section class="sect1" id="components-upgrade-controller-installation" data-id-title="Installing the Upgrade Controller"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.3 </span><span class="title-name">Installing the Upgrade Controller</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#components-upgrade-controller-installation">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><section class="sect2" id="id-prerequisites-6" data-id-title="Prerequisites"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">23.3.1 </span><span class="title-name">Prerequisites</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#id-prerequisites-6">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><a class="link" href="https://helm.sh/docs/intro/install/" target="_blank">Helm</a></p></li><li class="listitem"><p><a class="link" href="https://cert-manager.io/v1.15-docs/installation/helm/#installing-with-helm" target="_blank">cert-manager</a></p></li><li class="listitem"><p>System Upgrade Controller (<a class="xref" href="components-system-upgrade-controller.html#components-system-upgrade-controller-install" title="22.2. Installing the System Upgrade Controller">Section 22.2, “Installing the System Upgrade Controller”</a>)</p></li><li class="listitem"><p>A Kubernetes cluster; either K3s or RKE2</p></li></ul></div></section><section class="sect2" id="id-steps" data-id-title="Steps"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">23.3.2 </span><span class="title-name">Steps</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#id-steps">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Install the Upgrade Controller Helm chart on your management cluster:</p><div class="verbatim-wrap highlight bash"><pre class="screen">helm install upgrade-controller oci://registry.suse.com/edge/charts/upgrade-controller --version 304.0.1+up0.1.1 --create-namespace --namespace upgrade-controller-system</pre></div></li><li class="listitem"><p>Validate the Upgrade Controller deployment:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get deployment -n upgrade-controller-system</pre></div></li><li class="listitem"><p>Validate the Upgrade Controller pod:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get pods -n upgrade-controller-system</pre></div></li><li class="listitem"><p>Validate the Upgrade Controller pod logs:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl logs &lt;pod_name&gt; -n upgrade-controller-system</pre></div></li></ol></div></section></section><section class="sect1" id="components-upgrade-controller-how" data-id-title="How does the Upgrade Controller work?"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.4 </span><span class="title-name">How does the Upgrade Controller work?</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#components-upgrade-controller-how">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>In order to perform an Edge release upgrade, the Upgrade Controller introduces two new Kubernetes <a class="link" href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" target="_blank">custom resources</a>:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>UpgradePlan (<a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-extensions-upgrade-plan" title="23.5.1. UpgradePlan">Section 23.5.1, “UpgradePlan”</a>) - created by the user; holds configurations regarding an Edge release upgrade.</p></li><li class="listitem"><p>ReleaseManifest (<a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-extensions-release-manifest" title="23.5.2. ReleaseManifest">Section 23.5.2, “ReleaseManifest”</a>) - created by the Upgrade Controller; holds component versions specific to a particular Edge release version. <span class="strong"><strong>This file must not be edited by users.</strong></span></p></li></ul></div><p>The Upgrade Controller proceeds to create a <code class="literal">ReleaseManifest</code> resource that holds the component data for the Edge release version specified by the user under the <code class="literal">releaseVersion</code> property in the <code class="literal">UpgradePlan</code> resource.</p><p>Using the component data from the <code class="literal">ReleaseManifest</code>, the Upgrade Controller proceeds to upgrade the Edge release components in the following order:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Operating System (OS) (<a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-how-os" title="23.4.1. Operating System upgrade">Section 23.4.1, “Operating System upgrade”</a>).</p></li><li class="listitem"><p>Kubernetes (<a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-how-k8s" title="23.4.2. Kubernetes upgrade">Section 23.4.2, “Kubernetes upgrade”</a>).</p></li><li class="listitem"><p>Additional components (<a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-how-additional" title="23.4.3. Additional components upgrades">Section 23.4.3, “Additional components upgrades”</a>).</p></li></ol></div><div id="id-1.4.21.9.7" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>During the upgrade process, the Upgrade Controller continually outputs upgrade information to the created <code class="literal">UpgradePlan</code>. For more information on how to track the upgrade process, see Tracking the upgrade process (<a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-how-track" title="23.6. Tracking the upgrade process">Section 23.6, “Tracking the upgrade process”</a>).</p></div><section class="sect2" id="components-upgrade-controller-how-os" data-id-title="Operating System upgrade"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">23.4.1 </span><span class="title-name">Operating System upgrade</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#components-upgrade-controller-how-os">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>To upgrade the operating system, the Upgrade Controller creates SUC (<a class="xref" href="components-system-upgrade-controller.html" title="Chapter 22. System Upgrade Controller">Chapter 22, <em>System Upgrade Controller</em></a>) Plans that have the following naming template:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>For SUC Plans related to control plane node OS upgrades - <code class="literal">control-plane-&lt;os-name&gt;-&lt;os-version&gt;-&lt;suffix&gt;</code>.</p></li><li class="listitem"><p>For SUC Plans related to worker node OS upgrades - <code class="literal">workers-&lt;os-name&gt;-&lt;os-version&gt;-&lt;suffix&gt;</code>.</p></li></ul></div><p>Based on these plans, SUC proceeds to create workloads on each node of the cluster that perform the actual OS upgrade.</p><p>Depending on the <code class="literal">ReleaseManifest</code>, the OS upgrade may include:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Package only updates - for use-cases where the OS version does not change between Edge releases.</p></li><li class="listitem"><p>Full OS migration - for use-cases where the OS version changes between Edge releases.</p></li></ul></div><p>The upgrade is executed <span class="strong"><strong>one</strong></span> node at a time starting with the control plane nodes first. Only if the control-plane node upgrade finishes will the worker nodes begin to be upgraded.</p><div id="id-1.4.21.9.8.8" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>The Upgrade Controller configures the OS SUC Plans to do perform a <a class="link" href="https://kubernetes.io/docs/reference/kubectl/generated/kubectl_drain/" target="_blank">drain</a> of the cluster nodes if the cluster has more than <span class="strong"><strong>one</strong></span> node of the specified type.</p><p>For clusters where the control plane nodes are <span class="strong"><strong>greater than</strong></span> one and there is <span class="strong"><strong>only one</strong></span> worker node, a drain will be performed only for the control plane nodes and vice versa.</p><p>For information on how to disable node drains altogether, see the UpgradePlan (<a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-extensions-upgrade-plan" title="23.5.1. UpgradePlan">Section 23.5.1, “UpgradePlan”</a>) section.</p></div></section><section class="sect2" id="components-upgrade-controller-how-k8s" data-id-title="Kubernetes upgrade"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">23.4.2 </span><span class="title-name">Kubernetes upgrade</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#components-upgrade-controller-how-k8s">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>To upgrade the Kubernetes distribution of a cluster, the Upgrade Controller creates SUC (<a class="xref" href="components-system-upgrade-controller.html" title="Chapter 22. System Upgrade Controller">Chapter 22, <em>System Upgrade Controller</em></a>) Plans that have the following naming template:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>For SUC Plans related to control plane node Kubernetes upgrades - <code class="literal">control-plane-&lt;k8s-version&gt;-&lt;suffix&gt;</code>.</p></li><li class="listitem"><p>For SUC Plans related to worker node Kubernetes upgrades - <code class="literal">workers-&lt;k8s-version&gt;-&lt;suffix&gt;</code>.</p></li></ul></div><p>Based on these plans, SUC proceeds to create workloads on each node of the cluster that perform the actual Kubernetes upgrade.</p><p>The Kubernetes upgrade will happen <span class="strong"><strong>one</strong></span> node at a time starting with the control plane nodes first. Only if the control plane node upgrade finishes will the worker nodes begin to be upgraded.</p><div id="id-1.4.21.9.9.6" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>The Upgrade Controller configures the Kubernetes SUC Plans to perform a <a class="link" href="https://kubernetes.io/docs/reference/kubectl/generated/kubectl_drain/" target="_blank">drain</a> of the cluster nodes if the cluster has more than <span class="strong"><strong>one</strong></span> node of the specified type.</p><p>For clusters where the control plane nodes are <span class="strong"><strong>greater than</strong></span> one and there is <span class="strong"><strong>only one</strong></span> worker node, a drain will be performed only for the control plane nodes and vice versa.</p><p>For information on how to disable node drains altogether, see <a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-extensions-upgrade-plan" title="23.5.1. UpgradePlan">Section 23.5.1, “UpgradePlan”</a>.</p></div></section><section class="sect2" id="components-upgrade-controller-how-additional" data-id-title="Additional components upgrades"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">23.4.3 </span><span class="title-name">Additional components upgrades</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#components-upgrade-controller-how-additional">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>Currently, all additional components are installed via Helm charts. For a full list of the components for a specific release, refer to the Release Notes (<a class="xref" href="id-release-notes.html#release-notes" title="53.1. Abstract">Section 53.1, “Abstract”</a>).</p><p>For Helm charts deployed through EIB (<a class="xref" href="components-eib.html" title="Chapter 11. Edge Image Builder">Chapter 11, <em>Edge Image Builder</em></a>), the Upgrade Controller updates the existing <a class="link" href="https://docs.rke2.io/helm#using-the-helm-crd" target="_blank">HelmChart CR</a> of each component.</p><p>For Helm charts deployed outside of EIB, the Upgrade Controller creates a <code class="literal">HelmChart</code> resource for each component.</p><p>After the creation/update of the <code class="literal">HelmChart</code> resource, the Upgrade Controller relies on the <a class="link" href="https://github.com/k3s-io/helm-controller/" target="_blank">helm-controller</a> to pick up this change and proceed with the actual component upgrade.</p><p>Charts will be upgraded sequentially based on their order in the <code class="literal">ReleaseManifest</code>. Additional values can also be passed through the <code class="literal">UpgradePlan</code>. If a chart’s version remains unchanged in the new SUSE Edge release, it will not be upgraded. For more information about this, refer to <a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-extensions-upgrade-plan" title="23.5.1. UpgradePlan">Section 23.5.1, “UpgradePlan”</a>.</p></section></section><section class="sect1" id="components-upgrade-controller-extensions" data-id-title="Kubernetes API extensions"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.5 </span><span class="title-name">Kubernetes API extensions</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#components-upgrade-controller-extensions">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>Extensions to the Kubernetes API introduced by the Upgrade Controller.</p><section class="sect2" id="components-upgrade-controller-extensions-upgrade-plan" data-id-title="UpgradePlan"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">23.5.1 </span><span class="title-name">UpgradePlan</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#components-upgrade-controller-extensions-upgrade-plan">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>The Upgrade Controller introduces a new Kubernetes <a class="link" href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" target="_blank">custom resource</a> called an <code class="literal">UpgradePlan</code>.</p><p>The <code class="literal">UpgradePlan</code> serves as an instruction mechanism for the Upgrade Controller and it supports the following configurations:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><code class="literal">releaseVersion</code> - Edge release version to which the cluster should be upgraded to. The release version must follow <a class="link" href="https://semver.org" target="_blank">semantic</a> versioning and should be retrieved from the Release Notes (<a class="xref" href="id-release-notes.html#release-notes" title="53.1. Abstract">Section 53.1, “Abstract”</a>).</p></li><li class="listitem"><p><code class="literal">disableDrain</code> - <span class="strong"><strong>Optional</strong></span>; instructs the Upgrade Controller on whether to disable node <a class="link" href="https://kubernetes.io/docs/reference/kubectl/generated/kubectl_drain/" target="_blank">drains</a>. Useful for when you have workloads with <a class="link" href="https://kubernetes.io/docs/tasks/run-application/configure-pdb/" target="_blank">Disruption Budgets</a>.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Example for control plane node drain disablement:</p><div class="verbatim-wrap highlight yaml"><pre class="screen">spec:
  disableDrain:
    controlPlane: true</pre></div></li><li class="listitem"><p>Example for control plane and worker node drain disablement:</p><div class="verbatim-wrap highlight yaml"><pre class="screen">spec:
  disableDrain:
    controlPlane: true
    worker: true</pre></div></li></ul></div></li><li class="listitem"><p><code class="literal">helm</code> - <span class="strong"><strong>Optional</strong></span>; specifies additional values for components installed via Helm.</p><div id="id-1.4.21.10.3.4.3.2" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><div class="admon-title">Warning</div><p>It is only advised to use this field for values that are critical for upgrades. Standard chart value updates should be performed after the respective charts have been upgraded to the next version.</p></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Example:</p><div class="verbatim-wrap highlight yaml"><pre class="screen">spec:
  helm:
  - chart: foo
    values:
      bar: baz</pre></div></li></ul></div></li></ul></div></section><section class="sect2" id="components-upgrade-controller-extensions-release-manifest" data-id-title="ReleaseManifest"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">23.5.2 </span><span class="title-name">ReleaseManifest</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#components-upgrade-controller-extensions-release-manifest">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>The Upgrade Controller introduces a new Kubernetes <a class="link" href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" target="_blank">custom resource</a> called a <code class="literal">ReleaseManifest</code>.</p><p>The <code class="literal">ReleaseManifest</code> resource is created by the Upgrade Controller and holds component data for <span class="strong"><strong>one</strong></span> specific Edge release version. This means that each Edge release version upgrade will be represented by a different <code class="literal">ReleaseManifest</code> resource.</p><div id="id-1.4.21.10.4.4" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><div class="admon-title">Warning</div><p>The Release Manifest should always be created by the Upgrade Controller.</p><p>It is not advisable to manually create or edit the <code class="literal">ReleaseManifest</code> resources. Users that decide to do so should do this <span class="strong"><strong>at their own risk</strong></span>.</p></div><p>Component data that the Release Manifest ships include, but is not limited to:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Operating System data - version, supported architectures, additional upgrade data, etc.</p></li><li class="listitem"><p>Kubernetes distribution data - <a class="link" href="https://docs.rke2.io" target="_blank">RKE2</a>/<a class="link" href="https://k3s.io" target="_blank">K3s</a> supported versions</p></li><li class="listitem"><p>Additional components data - SUSE Helm chart data (location, version, name, etc.)</p></li></ul></div><p>For an example of how a Release Manifest can look, refer to the <a class="link" href="https://github.com/suse-edge/upgrade-controller/blob/main/config/samples/lifecycle_v1alpha1_releasemanifest.yaml" target="_blank">upstream</a> documentation. <span class="emphasis"><em>Please note that this is just an example and it is not intended to be created as a valid <code class="literal">ReleaseManifest</code> resource.</em></span></p></section></section><section class="sect1" id="components-upgrade-controller-how-track" data-id-title="Tracking the upgrade process"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.6 </span><span class="title-name">Tracking the upgrade process</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#components-upgrade-controller-how-track">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>This section serves as means to track and debug the upgrade process that the Upgrade Controller initiates once the user creates an <code class="literal">UpgradePlan</code> resource.</p><section class="sect2" id="components-upgrade-controller-how-track-general" data-id-title="General"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">23.6.1 </span><span class="title-name">General</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#components-upgrade-controller-how-track-general">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>General information about the state of the upgrade process can be viewed in the Upgrade Plan’s status conditions.</p><p>The Upgrade Plan resource’s status can be viewed in the following way:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get upgradeplan &lt;upgradeplan_name&gt; -n upgrade-controller-system -o yaml</pre></div><p><span class="formalpara-title">Running Upgrade Plan example:</span>
</p><div class="verbatim-wrap highlight yaml"><pre class="screen">apiVersion: lifecycle.suse.com/v1alpha1
kind: UpgradePlan
metadata:
  name: upgrade-plan-mgmt
  namespace: upgrade-controller-system
spec:
  releaseVersion: 3.4
status:
  conditions:
  - lastTransitionTime: "2024-10-01T06:26:27Z"
    message: Control plane nodes are being upgraded
    reason: InProgress
    status: "False"
    type: OSUpgraded
  - lastTransitionTime: "2024-10-01T06:26:27Z"
    message: Kubernetes upgrade is not yet started
    reason: Pending
    status: Unknown
    type: KubernetesUpgraded
  - lastTransitionTime: "2024-10-01T06:26:27Z"
    message: Rancher upgrade is not yet started
    reason: Pending
    status: Unknown
    type: RancherUpgraded
  - lastTransitionTime: "2024-10-01T06:26:27Z"
    message: Longhorn upgrade is not yet started
    reason: Pending
    status: Unknown
    type: LonghornUpgraded
  - lastTransitionTime: "2024-10-01T06:26:27Z"
    message: MetalLB upgrade is not yet started
    reason: Pending
    status: Unknown
    type: MetalLBUpgraded
  - lastTransitionTime: "2024-10-01T06:26:27Z"
    message: CDI upgrade is not yet started
    reason: Pending
    status: Unknown
    type: CDIUpgraded
  - lastTransitionTime: "2024-10-01T06:26:27Z"
    message: KubeVirt upgrade is not yet started
    reason: Pending
    status: Unknown
    type: KubeVirtUpgraded
  - lastTransitionTime: "2024-10-01T06:26:27Z"
    message: NeuVector upgrade is not yet started
    reason: Pending
    status: Unknown
    type: NeuVectorUpgraded
  - lastTransitionTime: "2024-10-01T06:26:27Z"
    message: EndpointCopierOperator upgrade is not yet started
    reason: Pending
    status: Unknown
    type: EndpointCopierOperatorUpgraded
  - lastTransitionTime: "2024-10-01T06:26:27Z"
    message: Elemental upgrade is not yet started
    reason: Pending
    status: Unknown
    type: ElementalUpgraded
  - lastTransitionTime: "2024-10-01T06:26:27Z"
    message: SRIOV upgrade is not yet started
    reason: Pending
    status: Unknown
    type: SRIOVUpgraded
  - lastTransitionTime: "2024-10-01T06:26:27Z"
    message: Akri upgrade is not yet started
    reason: Pending
    status: Unknown
    type: AkriUpgraded
  - lastTransitionTime: "2024-10-01T06:26:27Z"
    message: Metal3 upgrade is not yet started
    reason: Pending
    status: Unknown
    type: Metal3Upgraded
  - lastTransitionTime: "2024-10-01T06:26:27Z"
    message: RancherTurtles upgrade is not yet started
    reason: Pending
    status: Unknown
    type: RancherTurtlesUpgraded
  observedGeneration: 1
  sucNameSuffix: 90315a2b6d</pre></div><p>
</p><p>Here you can view every component that the Upgrade Controller will try to schedule an upgrade for. Each condition follows the below template:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><code class="literal">lastTransitionTime</code> - the last time that this component condition has transitioned from one status to another.</p></li><li class="listitem"><p><code class="literal">message</code> - message that indicates the current upgrade state of the specific component condition.</p></li><li class="listitem"><p><code class="literal">reason</code> - the current upgrade state of the specific component condition. Possible <code class="literal">reasons</code> include:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><code class="literal">Succeeded</code> - upgrade of the specific component is successful.</p></li><li class="listitem"><p><code class="literal">Failed</code> - upgrade of the specific component has failed.</p></li><li class="listitem"><p><code class="literal">InProgress</code> - upgrade of the specific component is currently in progress.</p></li><li class="listitem"><p><code class="literal">Pending</code> - upgrade of the specific component is not yet scheduled.</p></li><li class="listitem"><p><code class="literal">Skipped</code> - specific component is not found on the cluster, so its upgrade will be skipped.</p></li><li class="listitem"><p><code class="literal">Error</code> - specific component has encountered a transient error.</p></li></ul></div></li><li class="listitem"><p><code class="literal">status</code> - status of the current condition <code class="literal">type</code>, one of <code class="literal">True</code>, <code class="literal">False</code>, <code class="literal">Unknown</code>.</p></li><li class="listitem"><p><code class="literal">type</code> - indicator for the currently upgraded component.</p></li></ul></div><p>The Upgrade Controller creates SUC Plans for component conditions of type <code class="literal">OSUpgraded</code> and <code class="literal">KubernetesUpgraded</code>. To further track the SUC Plans created for these components, refer to <a class="xref" href="components-system-upgrade-controller.html#components-system-upgrade-controller-monitor-plans" title="22.3. Monitoring System Upgrade Controller Plans">Section 22.3, “Monitoring System Upgrade Controller Plans”</a>.</p><p>All other component condition types can be further tracked by viewing the resources created for them by the <a class="link" href="https://github.com/k3s-io/helm-controller/" target="_blank">helm-controller</a>. For more information, see
<a class="xref" href="components-upgrade-controller.html#components-upgrade-controller-how-track-helm" title="23.6.2. Helm Controller">Section 23.6.2, “Helm Controller”</a>.</p><p>An Upgrade Plan scheduled by the Upgrade Controller can be marked as <code class="literal">successful</code> once:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>There are no <code class="literal">Pending</code> or <code class="literal">InProgress</code> component conditions.</p></li><li class="listitem"><p>The <code class="literal">lastSuccessfulReleaseVersion</code> property points to the <code class="literal">releaseVersion</code> that is specified in the Upgrade Plan’s configuration. <span class="emphasis"><em>This property is added to the Upgrade Plan’s status by the Upgrade Controller once the upgrade process is successful.</em></span></p></li></ol></div><p><span class="formalpara-title">Successful <code class="literal">UpgradePlan</code> example:</span>
</p><div class="verbatim-wrap highlight yaml"><pre class="screen">apiVersion: lifecycle.suse.com/v1alpha1
kind: UpgradePlan
metadata:
  name: upgrade-plan-mgmt
  namespace: upgrade-controller-system
spec:
  releaseVersion: 3.4
status:
  conditions:
  - lastTransitionTime: "2024-10-01T06:26:48Z"
    message: All cluster nodes are upgraded
    reason: Succeeded
    status: "True"
    type: OSUpgraded
  - lastTransitionTime: "2024-10-01T06:26:59Z"
    message: All cluster nodes are upgraded
    reason: Succeeded
    status: "True"
    type: KubernetesUpgraded
  - lastTransitionTime: "2024-10-01T06:27:13Z"
    message: Chart rancher upgrade succeeded
    reason: Succeeded
    status: "True"
    type: RancherUpgraded
  - lastTransitionTime: "2024-10-01T06:27:13Z"
    message: Chart longhorn is not installed
    reason: Skipped
    status: "False"
    type: LonghornUpgraded
  - lastTransitionTime: "2024-10-01T06:27:13Z"
    message: Specified version of chart metallb is already installed
    reason: Skipped
    status: "False"
    type: MetalLBUpgraded
  - lastTransitionTime: "2024-10-01T06:27:13Z"
    message: Chart cdi is not installed
    reason: Skipped
    status: "False"
    type: CDIUpgraded
  - lastTransitionTime: "2024-10-01T06:27:13Z"
    message: Chart kubevirt is not installed
    reason: Skipped
    status: "False"
    type: KubeVirtUpgraded
  - lastTransitionTime: "2024-10-01T06:27:13Z"
    message: Chart neuvector-crd is not installed
    reason: Skipped
    status: "False"
    type: NeuVectorUpgraded
  - lastTransitionTime: "2024-10-01T06:27:14Z"
    message: Specified version of chart endpoint-copier-operator is already installed
    reason: Skipped
    status: "False"
    type: EndpointCopierOperatorUpgraded
  - lastTransitionTime: "2024-10-01T06:27:14Z"
    message: Chart elemental-operator upgrade succeeded
    reason: Succeeded
    status: "True"
    type: ElementalUpgraded
  - lastTransitionTime: "2024-10-01T06:27:15Z"
    message: Chart sriov-crd is not installed
    reason: Skipped
    status: "False"
    type: SRIOVUpgraded
  - lastTransitionTime: "2024-10-01T06:27:16Z"
    message: Chart akri is not installed
    reason: Skipped
    status: "False"
    type: AkriUpgraded
  - lastTransitionTime: "2024-10-01T06:27:19Z"
    message: Chart metal3 is not installed
    reason: Skipped
    status: "False"
    type: Metal3Upgraded
  - lastTransitionTime: "2024-10-01T06:27:27Z"
    message: Chart rancher-turtles is not installed
    reason: Skipped
    status: "False"
    type: RancherTurtlesUpgraded
  lastSuccessfulReleaseVersion: 3.4
  observedGeneration: 1
  sucNameSuffix: 90315a2b6d</pre></div><p>
</p></section><section class="sect2" id="components-upgrade-controller-how-track-helm" data-id-title="Helm Controller"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">23.6.2 </span><span class="title-name">Helm Controller</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#components-upgrade-controller-how-track-helm">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>This section covers how to track resources created by the <a class="link" href="https://github.com/k3s-io/helm-controller/" target="_blank">helm-controller</a>.</p><div id="id-1.4.21.11.4.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>The below steps assume that <code class="literal">kubectl</code> has been configured to connect to the cluster where the Upgrade Controller has been deployed to.</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Locate the <code class="literal">HelmChart</code> resource for the specific component:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get helmcharts -n kube-system</pre></div></li><li class="listitem"><p>Using the name of the <code class="literal">HelmChart</code> resource, locate the upgrade Pod that was created by the <code class="literal">helm-controller</code>:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl get pods -l helmcharts.helm.cattle.io/chart=&lt;helmchart_name&gt; -n kube-system

# Example for Rancher
kubectl get pods -l helmcharts.helm.cattle.io/chart=rancher -n kube-system
NAME                         READY   STATUS      RESTARTS   AGE
helm-install-rancher-tv9wn   0/1     Completed   0          16m</pre></div></li><li class="listitem"><p>View the logs of the component specific pod:</p><div class="verbatim-wrap highlight bash"><pre class="screen">kubectl logs &lt;pod_name&gt; -n kube-system</pre></div></li></ol></div></section></section><section class="sect1" id="components-upgrade-controller-known-issues" data-id-title="Known Limitations"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.7 </span><span class="title-name">Known Limitations</span></span> <a title="Permalink" class="permalink" href="components-upgrade-controller.html#components-upgrade-controller-known-issues">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Downstream cluster upgrades are not yet managed by the Upgrade Controller. For information on how to upgrade downstream clusters, refer to <a class="xref" href="day2-downstream-clusters.html" title="Chapter 37. Downstream clusters">Chapter 37, <em>Downstream clusters</em></a>.</p></li><li class="listitem"><p>The Upgrade Controller expects any additional SUSE Edge Helm charts that are deployed through EIB (<a class="xref" href="components-eib.html" title="Chapter 11. Edge Image Builder">Chapter 11, <em>Edge Image Builder</em></a>) to have their <a class="link" href="https://docs.rke2.io/helm#using-the-helm-crd" target="_blank">HelmChart CR</a> deployed in the <code class="literal">kube-system</code> namespace. To do this, configure the <code class="literal">installationNamespace</code> property in your EIB definition file. For more information, see the <a class="link" href="https://github.com/suse-edge/edge-image-builder/blob/main/docs/building-images.md#kubernetes" target="_blank">upstream</a> documentation.</p></li><li class="listitem"><p>Currently the Upgrade Controller has no way to determine the current running Edge release version on the management cluster. Ensure to provide an Edge release version that is greater than the currently running Edge release version on the cluster.</p></li><li class="listitem"><p>Currently the Upgrade Controller supports <span class="strong"><strong>non air-gapped</strong></span> environment upgrades only. <span class="strong"><strong>Air-gapped</strong></span> upgrades are not yet possible.</p></li></ul></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="components-system-upgrade-controller.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 22 </span>System Upgrade Controller</span></a> </div><div><a class="pagination-link next" href="components-suma.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 24 </span>SUSE Multi-Linux Manager</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="section"><a href="components-upgrade-controller.html#id-how-does-suse-edge-use-upgrade-controller"><span class="title-number">23.1 </span><span class="title-name">How does SUSE Edge use Upgrade Controller?</span></a></span></li><li><span class="section"><a href="components-upgrade-controller.html#components-upgrade-controller-uc-vs-suc"><span class="title-number">23.2 </span><span class="title-name">Upgrade Controller vs System Upgrade Controller</span></a></span></li><li><span class="section"><a href="components-upgrade-controller.html#components-upgrade-controller-installation"><span class="title-number">23.3 </span><span class="title-name">Installing the Upgrade Controller</span></a></span></li><li><span class="section"><a href="components-upgrade-controller.html#components-upgrade-controller-how"><span class="title-number">23.4 </span><span class="title-name">How does the Upgrade Controller work?</span></a></span></li><li><span class="section"><a href="components-upgrade-controller.html#components-upgrade-controller-extensions"><span class="title-number">23.5 </span><span class="title-name">Kubernetes API extensions</span></a></span></li><li><span class="section"><a href="components-upgrade-controller.html#components-upgrade-controller-how-track"><span class="title-number">23.6 </span><span class="title-name">Tracking the upgrade process</span></a></span></li><li><span class="section"><a href="components-upgrade-controller.html#components-upgrade-controller-known-issues"><span class="title-number">23.7 </span><span class="title-name">Known Limitations</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2025</span></div></div></footer></body></html>