<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SUSE Edge Documentation | Longhorn</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Longhorn"/>
<meta name="description" content="Longhorn is a lightweight, reliable and user-friendly distributed block storage system designed for Kubernetes. As an open source project, Longhorn w…"/>
<meta name="book-title" content="SUSE Edge Documentation"/>
<meta name="chapter-title" content="Chapter 13. Longhorn"/>
<meta name="tracker-url" content="https://github.com/suse-edge/suse-edge.github.io/issues/new"/>
<meta name="tracker-type" content="gh"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Longhorn"/>
<meta property="og:description" content="Longhorn is a lightweight, reliable and user-friendly distr…"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Longhorn"/>
<meta name="twitter:description" content="Longhorn is a lightweight, reliable and user-friendly distr…"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
    "inLanguage": "en",
    

    "headline": "Longhorn",
  
    "description": "Longhorn",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2024-04-25T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="components-rke2.html" title="Chapter 12. RKE2"/><link rel="next" href="components-neuvector.html" title="Chapter 14. NeuVector"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="wide offline js-off"><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">SUSE Edge Documentation</a><span> / </span><a class="crumb" href="id-components-used-2.html">Components Used</a><span> / </span><a class="crumb" href="components-longhorn.html">Longhorn</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">SUSE Edge Documentation</div><ol><li><a href="id-suse-edge-documentation.html" class=" "><span class="title-number"> </span><span class="title-name">SUSE Edge Documentation</span></a></li><li><a href="id-quick-starts.html" class="has-children "><span class="title-number">I </span><span class="title-name">Quick Starts</span></a><ol><li><a href="quickstart-metal3.html" class=" "><span class="title-number">1 </span><span class="title-name">BMC automated deployments with Metal<sup>3</sup></span></a></li><li><a href="quickstart-elemental.html" class=" "><span class="title-number">2 </span><span class="title-name">Remote host onboarding with Elemental</span></a></li><li><a href="quickstart-eib.html" class=" "><span class="title-number">3 </span><span class="title-name">Standalone clusters with Edge Image Builder</span></a></li></ol></li><li class="active"><a href="id-components-used-2.html" class="has-children you-are-here"><span class="title-number">II </span><span class="title-name">Components Used</span></a><ol><li><a href="components-rancher.html" class=" "><span class="title-number">4 </span><span class="title-name">Rancher</span></a></li><li><a href="components-fleet.html" class=" "><span class="title-number">5 </span><span class="title-name">Fleet</span></a></li><li><a href="components-slmicro.html" class=" "><span class="title-number">6 </span><span class="title-name">SLE Micro</span></a></li><li><a href="components-metal3.html" class=" "><span class="title-number">7 </span><span class="title-name">Metal<sup>3</sup></span></a></li><li><a href="components-eib.html" class=" "><span class="title-number">8 </span><span class="title-name">Edge Image Builder</span></a></li><li><a href="components-nmc.html" class=" "><span class="title-number">9 </span><span class="title-name">Edge Networking</span></a></li><li><a href="components-elemental.html" class=" "><span class="title-number">10 </span><span class="title-name">Elemental</span></a></li><li><a href="components-k3s.html" class=" "><span class="title-number">11 </span><span class="title-name">K3s</span></a></li><li><a href="components-rke2.html" class=" "><span class="title-number">12 </span><span class="title-name">RKE2</span></a></li><li><a href="components-longhorn.html" class=" you-are-here"><span class="title-number">13 </span><span class="title-name">Longhorn</span></a></li><li><a href="components-neuvector.html" class=" "><span class="title-number">14 </span><span class="title-name">NeuVector</span></a></li><li><a href="components-metallb.html" class=" "><span class="title-number">15 </span><span class="title-name">MetalLB</span></a></li><li><a href="components-kubevirt.html" class=" "><span class="title-number">16 </span><span class="title-name">Edge Virtualization</span></a></li></ol></li><li><a href="id-how-to-guides.html" class="has-children "><span class="title-number">III </span><span class="title-name">How-To Guides</span></a><ol><li><a href="guides-metallb-k3s.html" class=" "><span class="title-number">17 </span><span class="title-name">MetalLB on K3s (using L2)</span></a></li><li><a href="guides-metallb-kubernetes.html" class=" "><span class="title-number">18 </span><span class="title-name">MetalLB in front of the Kubernetes API server</span></a></li></ol></li><li><a href="id-third-party-integration.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Third-Party Integration</span></a><ol><li><a href="integrations-nats.html" class=" "><span class="title-number">19 </span><span class="title-name">NATS</span></a></li><li><a href="id-nvidia-gpus-on-sle-micro.html" class=" "><span class="title-number">20 </span><span class="title-name">NVIDIA GPUs on SLE Micro</span></a></li></ol></li><li><a href="id-product-documentation.html" class="has-children "><span class="title-number">V </span><span class="title-name">Product Documentation</span></a><ol><li><a href="atip.html" class=" "><span class="title-number">21 </span><span class="title-name">SUSE Adaptive Telco Infrastructure Platform (ATIP)</span></a></li><li><a href="atip-architecture.html" class=" "><span class="title-number">22 </span><span class="title-name">Concept &amp; Architecture</span></a></li><li><a href="atip-requirements.html" class=" "><span class="title-number">23 </span><span class="title-name">Requirements &amp; Assumptions</span></a></li><li><a href="atip-management-cluster.html" class=" "><span class="title-number">24 </span><span class="title-name">Setting up the management cluster</span></a></li><li><a href="atip-features.html" class=" "><span class="title-number">25 </span><span class="title-name">Telco features configuration</span></a></li><li><a href="atip-automated-provisioning.html" class=" "><span class="title-number">26 </span><span class="title-name">Automated provisioning with ZTP</span></a></li><li><a href="atip-lifecycle.html" class=" "><span class="title-number">27 </span><span class="title-name">Lifecycle actions</span></a></li></ol></li><li><a href="id-appendix.html" class=" "><span class="title-number">A </span><span class="title-name">Appendix</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="components-longhorn" data-id-title="Longhorn"><div class="titlepage"><div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">13 </span><span class="title-name">Longhorn</span></span> <a title="Permalink" class="permalink" href="components-longhorn.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>Longhorn is a lightweight, reliable and user-friendly distributed block storage system designed for Kubernetes.
As an open source project, Longhorn was initially developed by Rancher Labs and is currently incubated under the CNCF.</p><section class="sect1" id="id-prerequisites-4" data-id-title="Prerequisites"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">13.1 </span><span class="title-name">Prerequisites</span></span> <a title="Permalink" class="permalink" href="components-longhorn.html#id-prerequisites-4">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>SLE Micro</p></li><li class="listitem"><p>K3s or RKE2 installed. You can find a guide on how to install K3s <a class="link" href="https://documentation.suse.com/trd/kubernetes/single-html/kubernetes_ri_k3s-slemicro/index.html#id-k3s" target="_blank">here</a>
and RKE2 <a class="link" href="https://docs.rke2.io/install/quickstart" target="_blank">here</a>.</p></li><li class="listitem"><p>Open-iSCSI</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Install it on an existing SLE Micro by running <code class="literal">sudo transactional-update pkg install open-iscsi</code> and rebooting the host.</p></li><li class="listitem"><p>If you are building your images with Edge Image Builder, add <code class="literal">open-iscsi</code> to the packages list.</p></li></ul></div></li><li class="listitem"><p>Helm</p></li></ul></div></section><section class="sect1" id="id-installing-longhorn" data-id-title="Installing Longhorn"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">13.2 </span><span class="title-name">Installing Longhorn</span></span> <a title="Permalink" class="permalink" href="components-longhorn.html#id-installing-longhorn">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>To deploy <code class="literal">Longhorn</code>, use the <a class="link" href="https://longhorn.io/docs/1.6.0/deploy/install/install-with-helm/#installing-longhorn" target="_blank">Longhorn installation</a> guide.</p><p>In this example, Helm was used to install Longhorn.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Add the Longhorn Helm repository:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><code class="literal">helm repo add longhorn <a class="link" href="https://charts.longhorn.io" target="_blank">https://charts.longhorn.io</a></code></p></li></ul></div></li><li class="listitem"><p>Fetch the latest charts from the repository:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><code class="literal">helm repo update</code></p></li></ul></div></li><li class="listitem"><p>Install Longhorn in the longhorn-system namespace:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><code class="literal">helm install longhorn longhorn/longhorn --namespace longhorn-system --create-namespace --version 1.6.0</code></p></li></ul></div></li><li class="listitem"><p>To confirm that the deployment succeeded, run:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><code class="literal">kubectl -n longhorn-system get pod</code></p></li></ul></div></li></ul></div><div class="verbatim-wrap"><pre class="screen">localhost:~ # kubectl -n longhorn-system get pod
NAMESPACE         NAME                                                READY   STATUS      RESTARTS        AGE
longhorn-system   longhorn-ui-5fc9fb76db-z5dc9                        1/1     Running     0               90s
longhorn-system   longhorn-ui-5fc9fb76db-dcb65                        1/1     Running     0               90s
longhorn-system   longhorn-manager-wts2v                              1/1     Running     1 (77s ago)     90s
longhorn-system   longhorn-driver-deployer-5d4f79ddd-fxgcs            1/1     Running     0               90s
longhorn-system   instance-manager-a9bf65a7808a1acd6616bcd4c03d925b   1/1     Running     0               70s
longhorn-system   engine-image-ei-acb7590c-htqmp                      1/1     Running     0               70s
longhorn-system   csi-attacher-5c4bfdcf59-j8xww                       1/1     Running     0               50s
longhorn-system   csi-provisioner-667796df57-l69vh                    1/1     Running     0               50s
longhorn-system   csi-attacher-5c4bfdcf59-xgd5z                       1/1     Running     0               50s
longhorn-system   csi-provisioner-667796df57-dqkfr                    1/1     Running     0               50s
longhorn-system   csi-attacher-5c4bfdcf59-wckt8                       1/1     Running     0               50s
longhorn-system   csi-resizer-694f8f5f64-7n2kq                        1/1     Running     0               50s
longhorn-system   csi-snapshotter-959b69d4b-rp4gk                     1/1     Running     0               50s
longhorn-system   csi-resizer-694f8f5f64-r6ljc                        1/1     Running     0               50s
longhorn-system   csi-resizer-694f8f5f64-k7429                        1/1     Running     0               50s
longhorn-system   csi-snapshotter-959b69d4b-5k8pg                     1/1     Running     0               50s
longhorn-system   csi-provisioner-667796df57-n5w9s                    1/1     Running     0               50s
longhorn-system   csi-snapshotter-959b69d4b-x7b7t                     1/1     Running     0               50s
longhorn-system   longhorn-csi-plugin-bsc8c                           3/3     Running     0               50s</pre></div></section><section class="sect1" id="id-creating-longhorn-volumes" data-id-title="Creating Longhorn volumes"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">13.3 </span><span class="title-name">Creating Longhorn volumes</span></span> <a title="Permalink" class="permalink" href="components-longhorn.html#id-creating-longhorn-volumes">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Longhorn StorageClass Creation</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>First, create a Longhorn StorageClass containing parameters for provisioning PVs.
To create PersistentVolumeClaim (PVC), run:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><code class="literal">kubectl create -f &lt;NAME_OF_FILE.yaml&gt;</code></p></li><li class="listitem"><p>Example values:</p></li></ul></div></li></ul></div></li></ul></div><div class="verbatim-wrap highlight yaml"><pre class="screen">kind: StorageClass
apiVersion: storage.k8s.io/v1
metadata:
  name: longhorn
provisioner: driver.longhorn.io
allowVolumeExpansion: true
parameters:
  numberOfReplicas: "3"
  staleReplicaTimeout: "2880" # 48 hours in minutes
  fromBackup: ""
  fsType: "ext4"</pre></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Create a PVC referencing the StorageClass.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>The Kubernetes master checks the PVC to ensure the resource request can be fulfilled.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><code class="literal">kubectl create -f &lt;NAME_OF_FILE.yaml&gt;</code></p></li><li class="listitem"><p>Example values:</p></li></ul></div></li></ul></div></li></ul></div><div class="verbatim-wrap highlight yaml"><pre class="screen">apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: longhorn-volv-pvc
  namespace: longhorn-system
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: longhorn
  resources:
    requests:
      storage: 2Gi</pre></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Pod deployment</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>When the Pod is deployed, the Kubernetes master creates the Longhorn volume and binds it to the Pod if storage is available.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><code class="literal">kubectl create -f &lt;NAME_OF_FILE.yaml&gt;</code></p></li><li class="listitem"><p>Example values:</p></li></ul></div></li></ul></div></li></ul></div><div class="verbatim-wrap highlight yaml"><pre class="screen">apiVersion: v1
kind: Pod
metadata:
  name: volume-test
  namespace: longhorn-system
spec:
  containers:
  - name: volume-test
    image: nginx:stable-alpine
    imagePullPolicy: IfNotPresent
    volumeMounts:
    - name: volv
      mountPath: /data
    ports:
    - containerPort: 80
  volumes:
  - name: volv
    persistentVolumeClaim:
      claimName: longhorn-volv-pvc</pre></div><p>In this example, the result should look something like this:</p><div class="verbatim-wrap"><pre class="screen">localhost:~ # kubectl get storageclass
NAME                   PROVISIONER             RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE
local-path (default)   rancher.io/local-path   Delete          WaitForFirstConsumer   false                  25h
longhorn (default)     driver.longhorn.io      Delete          Immediate              true                   24h

localhost:~ # kubectl get pvc
NAME                  STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
longhorn-volv-pvc     Bound    pvc-ad598c98-4cb7-4216-aff6-a52f7e4ea6ac   2Gi        RWO            longhorn       22h

localhost:~ # kubectl get pods -A
NAMESPACE         NAME                                                READY   STATUS      RESTARTS        AGE
longhorn-system   longhorn-ui-5fc9fb76db-z5dc9                        1/1     Running     0               24h
longhorn-system   longhorn-ui-5fc9fb76db-dcb65                        1/1     Running     0               24h
longhorn-system   longhorn-manager-wts2v                              1/1     Running     1 (24h ago)     24h
longhorn-system   longhorn-driver-deployer-5d4f79ddd-fxgcs            1/1     Running     0               24h
longhorn-system   instance-manager-a9bf65a7808a1acd6616bcd4c03d925b   1/1     Running     0               24h
longhorn-system   engine-image-ei-acb7590c-htqmp                      1/1     Running     0               24h
longhorn-system   csi-attacher-5c4bfdcf59-j8xww                       1/1     Running     0               24h
longhorn-system   csi-provisioner-667796df57-l69vh                    1/1     Running     0               24h
longhorn-system   csi-attacher-5c4bfdcf59-xgd5z                       1/1     Running     0               24h
longhorn-system   csi-resizer-694f8f5f64-7n2kq                        1/1     Running     0               24h
longhorn-system   csi-snapshotter-959b69d4b-rp4gk                     1/1     Running     0               24h
longhorn-system   csi-resizer-694f8f5f64-r6ljc                        1/1     Running     0               24h
longhorn-system   csi-resizer-694f8f5f64-k7429                        1/1     Running     0               24h
longhorn-system   csi-snapshotter-959b69d4b-5k8pg                     1/1     Running     0               24h
longhorn-system   csi-provisioner-667796df57-n5w9s                    1/1     Running     0               24h
longhorn-system   csi-snapshotter-959b69d4b-x7b7t                     1/1     Running     0               24h
longhorn-system   longhorn-csi-plugin-bsc8c                           3/3     Running     0               24h
longhorn-system   csi-provisioner-667796df57-dqkfr                    1/1     Running     2 (8m45s ago)   24h
longhorn-system   csi-attacher-5c4bfdcf59-wckt8                       1/1     Running     2 (3m59s ago)   24h
longhorn-system   volume-test                                         1/1     Running     0               22h</pre></div></section><section class="sect1" id="id-accessing-the-ui" data-id-title="Accessing the UI"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">13.4 </span><span class="title-name">Accessing the UI</span></span> <a title="Permalink" class="permalink" href="components-longhorn.html#id-accessing-the-ui">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>If you installed Longhorn with kubectl or Helm, you need to set up an Ingress controller to
allow external traffic into the cluster. Authentication is not enabled by
default. If the Rancher catalog app was used, Rancher automatically created an Ingress controller with
access control (the rancher-proxy).</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Get the Longhorn’s external service IP:</p></li></ul></div><div class="verbatim-wrap"><pre class="screen">kubectl -n longhorn-system get svc</pre></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Once you have retrieved the longhorn-frontend IP, you can start using the UI by navigating to it in your browser.</p></li></ul></div></section><section class="sect1" id="id-using-edge-image-builder-to-deploy-longhorn" data-id-title="Using Edge Image Builder to deploy Longhorn"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">13.5 </span><span class="title-name">Using Edge Image Builder to deploy Longhorn</span></span> <a title="Permalink" class="permalink" href="components-longhorn.html#id-using-edge-image-builder-to-deploy-longhorn">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>The configuration file from below can be used to create an image via
the Edge Image Builder (<a class="xref" href="components-eib.html" title="Chapter 8. Edge Image Builder">Chapter 8, <em>Edge Image Builder</em></a>) with
Longhorn being set up as well.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Build the container:</p></li></ul></div><div class="verbatim-wrap"><pre class="screen">podman build -t eib:dev .</pre></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>This command attaches the directory and runs EIB. The $DEFINITION_FILE.yaml must contain the values from the YAML file below. It is customizable, but for our purpose this is enough to deploy Longhorn.</p></li></ul></div><div class="verbatim-wrap"><pre class="screen">podman run --rm -it -v $IMAGE_DIR:/eib eib:dev build --definition-file $DEFINITION_FILE.yaml</pre></div><div class="verbatim-wrap highlight yaml"><pre class="screen">apiVersion: 1.0
image:
  imageType: iso
  baseImage: SLE-Micro.x86_64-5.5.0-Default-SelfInstall-GM.install.iso
  arch: x86_64
  outputImageName: eib-image.iso
kubernetes:
  version: v1.28.7+rke2r1
  helm:
    charts:
      - name: longhorn
        version: 1.6.0
        repositoryName: longhorn
        targetNamespace: longhorn-system
        createNamespace: true
        installationNamespace: kube-system
        valuesFile: longhorn.yaml # optional! if we want to edit some of the default settings
    repositories:
      - name: longhorn
        url: https://charts.longhorn.io
operatingSystem:
  packages:
    sccRegistrationCode: &lt;reg-code&gt;
    packageList:
      - open-iscsi
  users:
  - username: root
    encryptedPassword: &lt;password&gt;</pre></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>If you want to customize the default values of the chart, do so by creating <code class="literal">./kubernetes/helm/values/longhorn.yaml</code>.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Retrieve a copy of the Longhorn <code class="literal">values.yaml</code> <a class="link" href="https://raw.githubusercontent.com/longhorn/charts/master/charts/longhorn/values.yaml" target="_blank">here</a>.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Now you can edit the defaultSettings in the file we created earlier under <code class="literal">./kubernetes/helm/values/longhorn.yaml</code>.</p></li></ul></div></li><li class="listitem"><p>Example YAML file that you can use to add the changes to the ConfigMap: <code class="literal">longhorn-default-setting</code>.</p></li></ul></div></li></ul></div><div class="verbatim-wrap highlight yaml"><pre class="screen">defaultSettings:
  defaultLonghornStaticStorageClass: longhorn-static-example
  backupstorePollInterval: 500
  priorityClass: high-priority</pre></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>After the image is built, you can use it to install your OS, and Longhorn will be deployed on top of RKE2.</p></li></ul></div></section><section class="sect1" id="id-using-edge-image-builder-to-deploy-longhorn-in-an-air-gapped-environment" data-id-title="Using Edge Image Builder to deploy Longhorn in an air-gapped environment"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">13.6 </span><span class="title-name">Using Edge Image Builder to deploy Longhorn in an air-gapped environment</span></span> <a title="Permalink" class="permalink" href="components-longhorn.html#id-using-edge-image-builder-to-deploy-longhorn-in-an-air-gapped-environment">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>We can install air-gapped Longhorn using Edge Image Builder by providing the images to the configuration file like this:</p></li></ul></div><div class="verbatim-wrap highlight yaml"><pre class="screen">embeddedArtifactRegistry:
  images:
    - name: longhornio/csi-attacher:v4.4.2
    - name: longhornio/csi-provisioner:v3.6.2
    - name: longhornio/csi-resizer:v1.9.2
    - name: longhornio/csi-snapshotter:v6.3.2
    - name: longhornio/csi-node-driver-registrar:v2.9.2
    - name: longhornio/livenessprobe:v2.12.0
    - name: longhornio/backing-image-manager:v1.6.1
    - name: longhornio/longhorn-engine:v1.6.1
    - name: longhornio/longhorn-instance-manager:v1.6.1
    - name: longhornio/longhorn-manager:v1.6.1
    - name: longhornio/longhorn-share-manager:v1.6.1
    - name: longhornio/longhorn-ui:v1.6.1
    - name: longhornio/support-bundle-kit:v0.0.36</pre></div><p>The images from above are for Longhorn 1.6.1, which is the latest version at the time of writing. If you would like to do an air-gap installation with older images or if newer ones exist, they can be located in the official Longhorn documentation under the specific version and Air Gap Installation. In this case, the documentation is available <a class="link" href="https://longhorn.io/docs/1.6.1/deploy/install/airgap/" target="_blank">here</a>, and the images can be found in <code class="literal">longhorn-images.txt</code>.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>See the full working example:</p></li></ul></div><div class="verbatim-wrap highlight yaml"><pre class="screen">apiVersion: 1.0
image:
    imageType: raw
    arch: x86_64
    baseImage: SLE-Micro.x86_64-5.5.0-Default-GM.raw
    outputImageName: longhorn.raw
kubernetes:
  version: v1.28.7+rke2r1
  helm:
    charts:
      - name: longhorn
        repositoryName: longhorn
        targetNamespace: longhorn-system
        createNamespace: true
        version: 1.6.1
    repositories:
      - name: longhorn
        url: https://charts.longhorn.io
operatingSystem:
  rawConfiguration:
    diskSize: 64G
  packages:
    sccRegistrationCode: &lt;reg-code&gt;
    packageList:
      - open-iscsi
  users:
  - username: root
    encryptedPassword: &lt;password&gt;
embeddedArtifactRegistry:
  images:
    - name: longhornio/csi-attacher:v4.4.2
    - name: longhornio/csi-provisioner:v3.6.2
    - name: longhornio/csi-resizer:v1.9.2
    - name: longhornio/csi-snapshotter:v6.3.2
    - name: longhornio/csi-node-driver-registrar:v2.9.2
    - name: longhornio/livenessprobe:v2.12.0
    - name: longhornio/backing-image-manager:v1.6.1
    - name: longhornio/longhorn-engine:v1.6.1
    - name: longhornio/longhorn-instance-manager:v1.6.1
    - name: longhornio/longhorn-manager:v1.6.1
    - name: longhornio/longhorn-share-manager:v1.6.1
    - name: longhornio/longhorn-ui:v1.6.1
    - name: longhornio/support-bundle-kit:v0.0.36</pre></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="components-rke2.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 12 </span>RKE2</span></a> </div><div><a class="pagination-link next" href="components-neuvector.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 14 </span>NeuVector</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="section"><a href="components-longhorn.html#id-prerequisites-4"><span class="title-number">13.1 </span><span class="title-name">Prerequisites</span></a></span></li><li><span class="section"><a href="components-longhorn.html#id-installing-longhorn"><span class="title-number">13.2 </span><span class="title-name">Installing Longhorn</span></a></span></li><li><span class="section"><a href="components-longhorn.html#id-creating-longhorn-volumes"><span class="title-number">13.3 </span><span class="title-name">Creating Longhorn volumes</span></a></span></li><li><span class="section"><a href="components-longhorn.html#id-accessing-the-ui"><span class="title-number">13.4 </span><span class="title-name">Accessing the UI</span></a></span></li><li><span class="section"><a href="components-longhorn.html#id-using-edge-image-builder-to-deploy-longhorn"><span class="title-number">13.5 </span><span class="title-name">Using Edge Image Builder to deploy Longhorn</span></a></span></li><li><span class="section"><a href="components-longhorn.html#id-using-edge-image-builder-to-deploy-longhorn-in-an-air-gapped-environment"><span class="title-number">13.6 </span><span class="title-name">Using Edge Image Builder to deploy Longhorn in an air-gapped environment</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>